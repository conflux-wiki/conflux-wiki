<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Conflux Wiki Team">
        <link rel="canonical" href="https://conflux-wiki.github.io/crypto/hash/attack/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Hash Attack - Conflux Wiki</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../../static/css/extra.css" rel="stylesheet">

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">Conflux Wiki</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Start <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../.." class="dropdown-item">简介</a>
</li>
                                    
<li>
    <a href="../../../usage/" class="dropdown-item">如何使用 Conflux Wiki</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">贡献指南</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../contribute/before-contributing/" class="dropdown-item">贡献之前</a>
</li>
            
<li>
    <a href="../../../contribute/basic-contribute-approach/" class="dropdown-item">基本贡献方式</a>
</li>
            
<li>
    <a href="../../../contribute/documentation-requirement/" class="dropdown-item">贡献文档要求</a>
</li>
            
<li>
    <a href="../../../contribute/translation/" class="dropdown-item">翻译</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../../discussion/" class="dropdown-item">讨论交流</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Introduction <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../introduction/history/" class="dropdown-item">区块链 历史</a>
</li>
                                    
<li>
    <a href="../../../introduction/link/" class="dropdown-item">Conflux相关链接</a>
</li>
                                    
<li>
    <a href="../../../introduction/highlight-time/" class="dropdown-item">重要时刻</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Crypto <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../introduction/" class="dropdown-item">密码学简介</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">基础数学知识</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../basic/introduction/" class="dropdown-item">基础数学知识</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">古典密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../classical/introduction/" class="dropdown-item">古典密码简介</a>
</li>
            
<li>
    <a href="../../classical/monoalphabetic/" class="dropdown-item">单表代换加密</a>
</li>
            
<li>
    <a href="../../classical/polyalphabetic/" class="dropdown-item">多表代换加密</a>
</li>
            
<li>
    <a href="../../classical/others/" class="dropdown-item">其它类型加密</a>
</li>
            
<li>
    <a href="../../classical/summary/" class="dropdown-item">总结</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/intro/" class="dropdown-item">流密码</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">伪随机数生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/prng/intro/" class="dropdown-item">伪随机数生成器介绍</a>
</li>
            
<li>
    <a href="../../streamcipher/prng/csprng/" class="dropdown-item">密码安全伪随机数生成器</a>
</li>
            
<li>
    <a href="../../streamcipher/prng/problem/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">线性同余生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/lcg/intro/" class="dropdown-item">线性同余生成器</a>
</li>
            
<li>
    <a href="../../streamcipher/lcg/challenge/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">反馈移位寄存器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/fsr/intro/" class="dropdown-item">反馈移位寄存器</a>
</li>
            
<li>
    <a href="../../streamcipher/fsr/lfsr/" class="dropdown-item">线性反馈移位寄存器 - LFSR</a>
</li>
            
<li>
    <a href="../../streamcipher/fsr/nfsr/" class="dropdown-item">非线性反馈移位寄存器</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">特殊流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/special/rc4/" class="dropdown-item">RC4</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">块加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/introduction/" class="dropdown-item">块加密</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ARX</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/arx-operations/" class="dropdown-item">ARX: Add-Rotate-Xor</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">DES</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/des/" class="dropdown-item">DES</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">IDEA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/idea/" class="dropdown-item">IDEA</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">AES</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/aes/" class="dropdown-item">AES</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Simon and Speck</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/simon-speck/" class="dropdown-item">Simon and Speck Block Ciphers</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">分组模式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/mode/introduction/" class="dropdown-item">分组模式</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/padding/" class="dropdown-item">填充方式</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ecb/" class="dropdown-item">ECB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/cbc/" class="dropdown-item">CBC</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/pcbc/" class="dropdown-item">PCBC</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/cfb/" class="dropdown-item">CFB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ofb/" class="dropdown-item">OFB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ctr/" class="dropdown-item">CTR</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/padding-oracle-attack/" class="dropdown-item">Padding Oracle Attack</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">非对称加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/introduction/" class="dropdown-item">介绍</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/rsa/rsa_theory/" class="dropdown-item">RSA 介绍</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_module_attack/" class="dropdown-item">模数相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_e_attack/" class="dropdown-item">公钥指数相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_d_attack/" class="dropdown-item">私钥 d 相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_coppersmith_attack/" class="dropdown-item">Coppersmith 相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_chosen_plain_cipher/" class="dropdown-item">RSA 选择明密文攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_side_channel/" class="dropdown-item">RSA 侧信道攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_pkcs_attack/" class="dropdown-item">Bleichenbacher's attack</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_complex/" class="dropdown-item">RSA 复杂题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">背包加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/knapsack/knapsack/" class="dropdown-item">背包加密</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">离散对数相关</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/discrete-log/discrete-log/" class="dropdown-item">离散对数</a>
</li>
            
<li>
    <a href="../../asymmetric/discrete-log/elgamal/" class="dropdown-item">ElGamal</a>
</li>
            
<li>
    <a href="../../asymmetric/discrete-log/ecc/" class="dropdown-item">ECC</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">格密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/lattice/overview/" class="dropdown-item">格概述</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/introduction/" class="dropdown-item">基本介绍</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/lattice-reduction/" class="dropdown-item">格基规约算法</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/cvp/" class="dropdown-item">CVP</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">哈希函数</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../introduction/" class="dropdown-item">哈希函数</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">MD5</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../md5/" class="dropdown-item">MD5</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SHA1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../sha1/" class="dropdown-item">SHA1</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">FNV</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../fnv/" class="dropdown-item">Fowler–Noll–Vo hash function</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Hash Attack</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="./" class="dropdown-item active">Hash Attack</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../complex/" class="dropdown-item">综合题目</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../signature/introduction/" class="dropdown-item">数字签名</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../signature/rsa/" class="dropdown-item">RSA 数字签名</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ElGamal 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../signature/elgamal/" class="dropdown-item">ElGamal</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">DSA 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../signature/dsa/" class="dropdown-item">DSA</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">攻击思想总结</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../attack-summary/attack-mode/" class="dropdown-item">简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">中间相遇攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../attack-summary/meet-in-the-middle/" class="dropdown-item">中间相遇攻击 - MITM</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">比特攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../attack-summary/bit-attack/" class="dropdown-item">比特攻击</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">证书格式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../certificate/introduction/" class="dropdown-item">证书格式</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Development <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../development/introduction/" class="dropdown-item">Conflux应用开发入门</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">生态开发激励</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../development/incentive-guide/" class="dropdown-item">生态激励指南</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">开发工具及相关资源介绍</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../development/tools/" class="dropdown-item">开发工具</a>
</li>
            
<li>
    <a href="../../../development/resources/" class="dropdown-item">开发资源</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ConfluxScan教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../development/apply-contract-fee/" class="dropdown-item">为合约申请Conflux赞助额度（合约代付）</a>
</li>
            
<li>
    <a href="../../../development/address-NFT/" class="dropdown-item">NFT查看器教程</a>
</li>
            
<li>
    <a href="../../../development/register-contract-and-token-display/" class="dropdown-item">如何在Scan上注册合约和代币展示</a>
</li>
            
<li>
    <a href="../../../development/get-lp-token-address/" class="dropdown-item">查找LP代币的合约地址</a>
</li>
            
<li>
    <a href="../../../development/internal-transaction/" class="dropdown-item">交易分析</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Portal钱包教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../development/portal/" class="dropdown-item">Portal安装配置步骤</a>
</li>
            
<li>
    <a href="../../../development/portal-setting/" class="dropdown-item">Portal钱包常用功能解析</a>
</li>
            
<li>
    <a href="../../../development/add-token-to-portal/" class="dropdown-item">添加CRC20代币到Portal的方法与步骤</a>
</li>
            
<li>
    <a href="../../../development/portal-faucet/" class="dropdown-item">ConfluxPortal切换为测试网领取测试币教程</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Ecosystem <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../ecosystem/introduction/" class="dropdown-item">生态介绍</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Conflux基础生态教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../ecosystem/wcfx-cfx-exchange/" class="dropdown-item">WCFX与CFX代币互换</a>
</li>
            
<li>
    <a href="../../../ecosystem/governance/" class="dropdown-item">Staking合约的质押与解质押</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">常见生态介绍及教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../ecosystem/tspace/" class="dropdown-item">Tspace 4.0 NFT平台</a>
</li>
            
<li>
    <a href="../../../ecosystem/nft-box/" class="dropdown-item">NFTBox创新型资产交互平台</a>
</li>
            
<li>
    <a href="../../../ecosystem/shuttleflow/" class="dropdown-item">Shuttleflow跨链工具</a>
</li>
            
<li>
    <a href="../../../ecosystem/moonswap/" class="dropdown-item">moonswap生态</a>
</li>
            
<li>
    <a href="../../../ecosystem/phantom/" class="dropdown-item">Phantom协议</a>
</li>
            
<li>
    <a href="../../../ecosystem/dan/" class="dropdown-item">炼丹西游</a>
</li>
            
<li>
    <a href="../../../ecosystem/guguo/" class="dropdown-item">古国序列</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Web <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../web/introduction/" class="dropdown-item">Web 简介</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SQL 注入</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../web/sqli/" class="dropdown-item">SQL 注入</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">XSS 跨站脚本攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../web/xss/" class="dropdown-item">XSS</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">CSRF 跨站请求伪造</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../web/csrf/" class="dropdown-item">CSRF</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SSRF 服务端请求伪造</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../web/ssrf/" class="dropdown-item">SSRF</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">PHP 代码审计</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../web/php/php/" class="dropdown-item">PHP 代码审计</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">BlockChain <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../blockchain/introduction/" class="dropdown-item">BlockChain Security Overview</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Ethereum Security</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockchain/ethereum/introduction/" class="dropdown-item">Ethereum Overview</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/basics/" class="dropdown-item">Ethereum Basics</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/selector-encoding/" class="dropdown-item">Function Selector and Argument Encoding</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/storage/" class="dropdown-item">Ethereum Storage</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/opcodes/" class="dropdown-item">Ethereum Opcodes</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Known Attacks</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockchain/ethereum/attacks/introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/attacks/re-entrancy/" class="dropdown-item">Re-Entrancy</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/attacks/overflow-underflow/" class="dropdown-item">Integer Overflow and Underflow</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/attacks/randomness/" class="dropdown-item">Randomness</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/attacks/airdrop-hunting/" class="dropdown-item">Airdrop Hunting</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/attacks/shortaddress/" class="dropdown-item">Short Address Attack</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/attacks/delegatecall/" class="dropdown-item">Delegatecall</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/attacks/uninitialized-storage-pointer/" class="dropdown-item">Uninitialized Storage Pointer</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/attacks/arbitrarywrite/" class="dropdown-item">Arbitrary Writing</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/attacks/create2/" class="dropdown-item">CREATE2</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/attacks/jump-oriented-programming/" class="dropdown-item">Jump Oriented Programming</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../../blockchain/ethereum/reverse/" class="dropdown-item">Smart Contract Reverse</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/challenges/" class="dropdown-item">区块链比赛题目</a>
</li>
            
<li>
    <a href="../../../blockchain/ethereum/resources/" class="dropdown-item">学习资源</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Public Blockchain Security</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockchain/publicblockchain/introduction/" class="dropdown-item">Public Blockchain Security Overview</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">NFT <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../nft/introduction/" class="dropdown-item">初识NFT</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../fnv/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../complex/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/conflux-wiki/conflux-wiki/blob/master/docs/zh/docs/crypto/hash/attack.md" class="nav-link">Edit on conflux-wiki/conflux-wiki</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#hash-attack" class="nav-link">Hash Attack</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">暴力攻击</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#hash-length-extension-attacks" class="nav-link">哈希长度拓展攻击（hash length extension attacks）</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#hash" class="nav-link">hash算法设计有误</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="hash-attack">Hash Attack<a class="headerlink" href="#hash-attack" title="Permanent link">&para;</a></h1>
<p>常见的Hash函数的攻击方法主要有</p>
<ul>
<li>暴力攻击：不依赖于任何算法细节，仅与Hash值长度有关；</li>
<li>生日攻击法(Birthday Attack)：没有利用Hash函数的结构和任何代数弱性质，只依赖于消息摘要的长度，即Hash值的长度。</li>
<li>中点交会攻击法(Meet-In-The-Middle)：是生日攻击的一种变形，不比较Hash值，而是比较中间变量。这种攻击主要适用于攻击具有分组链结构的Hash方案。</li>
<li>密码分析：依赖于具体算法的设计缺点。</li>
</ul>
<h2 id="_1">暴力攻击<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p><strong>HashCat 工具</strong> 可以说是目前最好的基于 CPU 和 GPU 破解 Hash 的软件，相关链接如下</p>
<p><a href="http://www.hashcat.net/hashcat/">HashCat 官网</a></p>
<p><a href="http://www.freebuf.com/sectool/112479.html">HashCat 简单使用</a></p>
<h2 id="hash-length-extension-attacks">哈希长度拓展攻击（hash length extension attacks）<a class="headerlink" href="#hash-length-extension-attacks" title="Permanent link">&para;</a></h2>
<h3 id="_2">介绍<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>基本定义如下，源自<a href="https://zh.wikipedia.org/wiki/%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB">维基百科</a>。</p>
<p>哈希长度扩展攻击(Hash Length Extension Attacks)是指针对某些允许包含额外信息的加密散列函数的攻击手段。该攻击适用于在<strong>消息与密钥的长度已知</strong>的情形下，所有采取了 H(key ∥ message) 此类构造的散列函数。MD5和SHA-1 等基于 Merkle–Damgård 构造的算法均对此类攻击显示出脆弱性。</p>
<p>这类哈希函数有以下特点</p>
<ul>
<li>消息填充方式都比较类似，首先在消息后面添加一个1，然后填充若干个0，直至总长度与 448 同余，最后在其后附上64位的消息长度（填充前）。</li>
<li>每一块得到的链接变量都会被作为下一次执行hash函数的初始向量IV。在最后一块的时候，才会将其对应的链接变量转换为hash值。</li>
</ul>
<p>一般攻击时应满足如下条件</p>
<ul>
<li>我们已知 key 的长度，如果不知道的话，需要爆破出来</li>
<li>我们可以控制 message 的消息。</li>
<li>我们已经知道了包含 key 的一个消息的hash值。</li>
</ul>
<p>这样我们就可以得到一对(messge,x)满足x=H(key ∥ message)虽然我们并不清楚key的内容。</p>
<h3 id="_3">攻击原理<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>这里不妨假设我们我们知道了 hash(key+s) 的 hash 值，其中 s 是已知的，那么其本身在计算的时候，必然会进行填充。那么我们首先可以得到 key+s 扩展后的字符串 now，即</p>
<p>now=key|s|padding</p>
<p>那么如果我们在 now 的后面再次附加上一部分信息extra，即</p>
<p>key|s|padding|extra</p>
<p>这样再去计算hash值的时候，</p>
<ol>
<li>会对 extra 进行填充直到满足条件。</li>
<li>先计算 now 对应的链接变量 IV1，而我们已经知道这部分的 hash 值，并且链接变量产生 hash 值的算法是可逆的，所以我们可以得到链接变量。</li>
<li>下面会根据得到的链接变量 IV1，对 extra 部分进行哈希算法，并返回hash值。</li>
</ol>
<p>那么既然我们已经知道了第一部分的 hash 值，并且，我们还知道 extra 的值，那么我们便可以得到最后的hash值。</p>
<p>而之前我们也说了我们可以控制 message 的值。那么其实 s，padding，extra 我们都是可以控制的。所以我们自然可以找到对应的(message,x)满足x=hash(key|message)。</p>
<h3 id="_4">例子<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>似乎大都是web里面的，，不太懂web，暂时先不给例子了。</p>
<h3 id="_5">工具<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://github.com/bwall/HashPump">hashpump</a></li>
</ul>
<p>如何使用请参考github上的readme。</p>
<h2 id="hash">hash算法设计有误<a class="headerlink" href="#hash" title="Permanent link">&para;</a></h2>
<p>一些自定义的hash算法可能是可逆的。</p>
<h3 id="hashinator">Hashinator<a class="headerlink" href="#hashinator" title="Permanent link">&para;</a></h3>
<p>题目的逻辑很简单，从一个知名的密码字典"rockyou"挑选出一个<code>password</code>，并且使用多种hash算法随机的哈希32轮。我们需要从最后的hash结果中破解出原始的<code>password</code>。</p>
<h4 id="_6">分析<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<p>题目采用的hash算法有：<code>md5</code>，<code>sha1</code>，<code>blake</code>，<code>scrypt</code>。
关键的代码如下：
<pre class="highlight"><code class="language-python">    password = self.generate_password()     # from rock_you.txt
    salt = self.generate_salt(password)     # 与password的长度有关
    hash_rounds = self.generate_rounds()    # 生成进行hash算法的顺序
    password_hash = self.calculate_hash(salt + password, hash_rounds)</code></pre>
1. 程序首先通过从<code>rockyou.txt</code>中随机抽取一个<code>password</code>，作为加密的明文。
2. 然后根据抽取的<code>password</code>的长度，生成一个长度为<code>128 - len(password)</code>的<code>salt</code>。
3. 从之前列举的4种hash算法中抽取，组成32轮的哈希运算。
4. 根据之前得到的<code>password</code>、<code>salt</code>计算出最后给我们的<code>password_hash</code>。</p>
<p>很明显，我们不可能通过逆向hash算法来完成题目。
我们知道所有的可能的明文，首先考虑能否通过构造彩虹表来完成穷举。但是注意到<code>generate_salt()</code>函数中，<code>salt</code>和<code>password</code>的长度组合超过了128byte的长度，并且被注释了
<pre class="highlight"><code>    msize = 128 # f-you hashcat :D</code></pre>
so，只能无奈放弃。</p>
<p>那这样的话，只存在一种可能，也即算法可逆。查看<code>calculate_hash()</code>函数的具体实现，可以发现如下可疑的代码：
<pre class="highlight"><code class="language-python">for i in range(len(hash_rounds)):
    interim_salt = xor(interim_salt, hash_rounds[-1-i](interim_hash))
    interim_hash = xor(interim_hash, hash_rounds[i](interim_salt))
final_hash = interim_salt + interim_hash</code></pre>
重新梳理一下我们知道的信息：
1. hash_rounds中保存了32轮，即每轮要使用的hash函数句柄。
2. final_hash是最后给我们的hash结果。
3. hash_rounds中的内容也会在生成之后打印给我们。
4. 我们希望得到<code>interim_salt</code>和<code>interim_hash</code>在第一轮的值。
5. <code>interim_salt</code>和<code>interim_hash</code>的长度均为64byte。</p>
<p>仔细观察一下<code>interim_salt</code>和<code>interim_hash</code>的计算方法，可以发现它是可逆的。</p>
<div class="arithmatex">
<div class="MathJax_Preview">
interim\_hash_1 = interim\_hash_2 \oplus hash\_rounds[i](interim\_salt_3)
</div>
<script type="math/tex; mode=display">
interim\_hash_1 = interim\_hash_2 \oplus hash\_rounds[i](interim\_salt_3)
</script>
</div>
<p>这行代码里，我们已知 <span class="arithmatex"><span class="MathJax_Preview">interim\_hash_1</span><script type="math/tex">interim\_hash_1</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">interim\_salt_3</span><script type="math/tex">interim\_salt_3</script></span>，由此可以推出<span class="arithmatex"><span class="MathJax_Preview">interim\_hash_2</span><script type="math/tex">interim\_hash_2</script></span>的值，而<span class="arithmatex"><span class="MathJax_Preview">interim\_hash_2</span><script type="math/tex">interim\_hash_2</script></span>则是上一轮的<code>interim_hash</code>。
以此方法逆推32次，则可以得到最初的<code>password</code>和<code>salt</code>。</p>
<p>具体的解密脚本为：
<pre class="highlight"><code class="language-python">import os
import hashlib
import socket
import threading
import socketserver
import struct
import time
import threading
# import pyscrypt
from base64 import b64encode, b64decode
from pwn import *
def md5(bytestring):
    return hashlib.md5(bytestring).digest()
def sha(bytestring):
    return hashlib.sha1(bytestring).digest()
def blake(bytestring):
    return hashlib.blake2b(bytestring).digest()
def scrypt(bytestring):
    l = int(len(bytestring) / 2)
    salt = bytestring[:l]
    p = bytestring[l:]
    return hashlib.scrypt(p, salt=salt, n=2**16, r=8, p=1, maxmem=67111936)
    # return pyscrypt.hash(p, salt, 2**16, 8, 1, dkLen=64)
def xor(s1, s2):
    return b''.join([bytes([s1[i] ^ s2[i % len(s2)]]) for i in range(len(s1))])
def main():
    # io = socket.socket(family=socket.AF_INET)
    # io.connect(('47.88.216.38', 20013))
    io = remote('47.88.216.38', 20013)
    print(io.recv(1000))
    ans_array = bytearray()
    while True:
        buf = io.recv(1)
        if buf:
            ans_array.extend(buf)
        if buf == b'!':
            break

    password_hash_base64 = ans_array[ans_array.find(b"b'") + 2: ans_array.find(b"'\n")]
    password_hash = b64decode(password_hash_base64)
    print('password:', password_hash)
    method_bytes = ans_array[
        ans_array.find(b'used:\n') + 6 : ans_array.find(b'\nYour')
    ]
    methods = method_bytes.split(b'\n')
    methods = [bytes(x.strip(b'- ')).decode() for x in methods]
    print(methods)
    in_salt = password_hash[:64]
    in_hash = password_hash[64:]
    for pos, neg in zip(methods, methods[::-1]):
        '''
            interim_salt = xor(interim_salt, hash_rounds[-1-i](interim_hash))
            interim_hash = xor(interim_hash, hash_rounds[i](interim_salt))
        '''
        in_hash = xor(in_hash, eval("{}(in_salt)".format(neg)))
        in_salt = xor(in_salt, eval("{}(in_hash)".format(pos)))
    print(in_hash, in_salt)
    print(in_hash[-20:])
    io.interactive()
main()
</code></pre></p>
<h4 id="hash_1">原hash算法<a class="headerlink" href="#hash_1" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-python">
import os
import hashlib
import socket
import threading
import socketserver
import struct
import time

# import pyscrypt

from base64 import b64encode

def md5(bytestring):
    return hashlib.md5(bytestring).digest()

def sha(bytestring):
    return hashlib.sha1(bytestring).digest()

def blake(bytestring):
    return hashlib.blake2b(bytestring).digest()

def scrypt(bytestring):
    l = int(len(bytestring) / 2)
    salt = bytestring[:l]
    p = bytestring[l:]
    return hashlib.scrypt(p, salt=salt, n=2**16, r=8, p=1, maxmem=67111936)
    # return pyscrypt.hash(p, salt, 2**16, 8, 1)

def xor(s1, s2):
    return b''.join([bytes([s1[i] ^ s2[i % len(s2)]]) for i in range(len(s1))])

class HashHandler(socketserver.BaseRequestHandler):

    welcome_message = """
Welcome, young wanna-be Cracker, to the Hashinator.

To prove your worthiness, you must display the power of your cracking skills.

The test is easy:
1. We send you a password from the rockyou list, hashed using multiple randomly chosen algorithms.
2. You crack the hash and send back the original password.

As you already know the dictionary and won't need any fancy password rules, {} seconds should be plenty, right?

Please wait while we generate your hash...
    """

    hashes = [md5, sha, blake, scrypt]
    timeout = 10
    total_rounds = 32

    def handle(self):
        self.request.sendall(self.welcome_message.format(self.timeout).encode())

        password = self.generate_password()     # from rock_you.txt
        salt = self.generate_salt(password)     # 与password的长度有关
        hash_rounds = self.generate_rounds()    # 生成进行hash算法的顺序
        password_hash = self.calculate_hash(salt + password, hash_rounds)
        self.generate_delay()

        self.request.sendall("Challenge password hash: {}\n".format(b64encode(password_hash)).encode())
        self.request.sendall("Rounds used:\n".encode())
        test_rounds = []
        for r in hash_rounds:
            test_rounds.append(r)

        for r in hash_rounds:
            self.request.sendall("- {}\n".format(r.__name__).encode())
        self.request.sendall("Your time starts now!\n".encode())
        self.request.settimeout(self.timeout)
        try:
            response = self.request.recv(1024)
            if response.strip() == password:
                self.request.sendall("Congratulations! You are a true cracking master!\n".encode())
                self.request.sendall("Welcome to the club: {}\n".format(flag).encode())
                return
        except socket.timeout:
            pass
        self.request.sendall("Your cracking skills are bad, and you should feel bad!".encode())


    def generate_password(self):
        rand = struct.unpack("I", os.urandom(4))[0]
        lines = 14344391 # size of rockyou
        line = rand % lines
        password = ""
        f = open('rockyou.txt', 'rb')
        for i in range(line):
            password = f.readline()
        return password.strip()

    def generate_salt(self, p):
        msize = 128 # f-you hashcat :D
        salt_size = msize - len(p)
        return os.urandom(salt_size)

    def generate_rounds(self):
        rand = struct.unpack("Q", os.urandom(8))[0]
        rounds = []
        for i in range(self.total_rounds):
            rounds.append(self.hashes[rand % len(self.hashes)])
            rand = rand &gt;&gt; 2
        return rounds

    def calculate_hash(self, payload, hash_rounds):
        interim_salt = payload[:64]
        interim_hash = payload[64:]
        for i in range(len(hash_rounds)):
            interim_salt = xor(interim_salt, hash_rounds[-1-i](interim_hash))
            interim_hash = xor(interim_hash, hash_rounds[i](interim_salt))
            '''
            interim_hash = xor(
                interim_hash,
                hash_rounds[i](
                    xor(interim_salt, hash_rounds[-1-i](interim_hash))
                )
            )
            '''
        final_hash = interim_salt + interim_hash
        return final_hash

    def generate_delay(self):
        rand = struct.unpack("I", os.urandom(4))[0]
        time.sleep(rand / 1000000000.0)



class ThreadedTCPServer(socketserver.ThreadingMixIn, socketserver.TCPServer):
    allow_reuse_address = True

PORT = 1337
HOST = '0.0.0.0'
flag = ""

with open("flag.txt") as f:
    flag = f.read()

def main():
    server = ThreadedTCPServer((HOST, PORT), HashHandler)
    server_thread = threading.Thread(target=server.serve_forever)
    server_thread.start()
    server_thread.join()

if __name__ == "__main__":
    main()

</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2020 - 2021 Conflux Wiki Team</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
        <script src="../../../static/js/extra.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
