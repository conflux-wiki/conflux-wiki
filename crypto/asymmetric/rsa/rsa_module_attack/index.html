<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Conflux Wiki Team">
        <link rel="canonical" href="https://conflux-wiki.github.io/crypto/asymmetric/rsa/rsa_module_attack/">
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>模数相关攻击 - Conflux Wiki</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../../../static/css/extra.css" rel="stylesheet">

        <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">Conflux Wiki</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Start <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../.." class="dropdown-item">简介</a>
</li>
                                    
<li>
    <a href="../../../../usage/" class="dropdown-item">如何使用 Conflux Wiki</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">贡献指南</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../contribute/before-contributing/" class="dropdown-item">贡献之前</a>
</li>
            
<li>
    <a href="../../../../contribute/basic-contribute-approach/" class="dropdown-item">基本贡献方式</a>
</li>
            
<li>
    <a href="../../../../contribute/documentation-requirement/" class="dropdown-item">贡献文档要求</a>
</li>
            
<li>
    <a href="../../../../contribute/translation/" class="dropdown-item">翻译</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../../../discussion/" class="dropdown-item">讨论交流</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Introduction <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../introduction/history/" class="dropdown-item">区块链 历史</a>
</li>
                                    
<li>
    <a href="../../../../introduction/link/" class="dropdown-item">Conflux相关链接</a>
</li>
                                    
<li>
    <a href="../../../../introduction/highlight-time/" class="dropdown-item">重要时刻</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Crypto <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../introduction/" class="dropdown-item">密码学简介</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">基础数学知识</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../basic/introduction/" class="dropdown-item">基础数学知识</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">古典密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../classical/introduction/" class="dropdown-item">古典密码简介</a>
</li>
            
<li>
    <a href="../../../classical/monoalphabetic/" class="dropdown-item">单表代换加密</a>
</li>
            
<li>
    <a href="../../../classical/polyalphabetic/" class="dropdown-item">多表代换加密</a>
</li>
            
<li>
    <a href="../../../classical/others/" class="dropdown-item">其它类型加密</a>
</li>
            
<li>
    <a href="../../../classical/summary/" class="dropdown-item">总结</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../streamcipher/intro/" class="dropdown-item">流密码</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">伪随机数生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../streamcipher/prng/intro/" class="dropdown-item">伪随机数生成器介绍</a>
</li>
            
<li>
    <a href="../../../streamcipher/prng/csprng/" class="dropdown-item">密码安全伪随机数生成器</a>
</li>
            
<li>
    <a href="../../../streamcipher/prng/problem/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">线性同余生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../streamcipher/lcg/intro/" class="dropdown-item">线性同余生成器</a>
</li>
            
<li>
    <a href="../../../streamcipher/lcg/challenge/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">反馈移位寄存器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../streamcipher/fsr/intro/" class="dropdown-item">反馈移位寄存器</a>
</li>
            
<li>
    <a href="../../../streamcipher/fsr/lfsr/" class="dropdown-item">线性反馈移位寄存器 - LFSR</a>
</li>
            
<li>
    <a href="../../../streamcipher/fsr/nfsr/" class="dropdown-item">非线性反馈移位寄存器</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">特殊流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../streamcipher/special/rc4/" class="dropdown-item">RC4</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">块加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/introduction/" class="dropdown-item">块加密</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ARX</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/arx-operations/" class="dropdown-item">ARX: Add-Rotate-Xor</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">DES</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/des/" class="dropdown-item">DES</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">IDEA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/idea/" class="dropdown-item">IDEA</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">AES</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/aes/" class="dropdown-item">AES</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Simon and Speck</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/simon-speck/" class="dropdown-item">Simon and Speck Block Ciphers</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">分组模式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/mode/introduction/" class="dropdown-item">分组模式</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/padding/" class="dropdown-item">填充方式</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/ecb/" class="dropdown-item">ECB</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/cbc/" class="dropdown-item">CBC</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/pcbc/" class="dropdown-item">PCBC</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/cfb/" class="dropdown-item">CFB</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/ofb/" class="dropdown-item">OFB</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/ctr/" class="dropdown-item">CTR</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/padding-oracle-attack/" class="dropdown-item">Padding Oracle Attack</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">非对称加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../introduction/" class="dropdown-item">介绍</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../rsa_theory/" class="dropdown-item">RSA 介绍</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">模数相关攻击</a>
</li>
            
<li>
    <a href="../rsa_e_attack/" class="dropdown-item">公钥指数相关攻击</a>
</li>
            
<li>
    <a href="../rsa_d_attack/" class="dropdown-item">私钥 d 相关攻击</a>
</li>
            
<li>
    <a href="../rsa_coppersmith_attack/" class="dropdown-item">Coppersmith 相关攻击</a>
</li>
            
<li>
    <a href="../rsa_chosen_plain_cipher/" class="dropdown-item">RSA 选择明密文攻击</a>
</li>
            
<li>
    <a href="../rsa_side_channel/" class="dropdown-item">RSA 侧信道攻击</a>
</li>
            
<li>
    <a href="../rsa_pkcs_attack/" class="dropdown-item">Bleichenbacher's attack</a>
</li>
            
<li>
    <a href="../rsa_complex/" class="dropdown-item">RSA 复杂题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">背包加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../knapsack/knapsack/" class="dropdown-item">背包加密</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">离散对数相关</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../discrete-log/discrete-log/" class="dropdown-item">离散对数</a>
</li>
            
<li>
    <a href="../../discrete-log/elgamal/" class="dropdown-item">ElGamal</a>
</li>
            
<li>
    <a href="../../discrete-log/ecc/" class="dropdown-item">ECC</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">格密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../lattice/overview/" class="dropdown-item">格概述</a>
</li>
            
<li>
    <a href="../../lattice/introduction/" class="dropdown-item">基本介绍</a>
</li>
            
<li>
    <a href="../../lattice/lattice-reduction/" class="dropdown-item">格基规约算法</a>
</li>
            
<li>
    <a href="../../lattice/cvp/" class="dropdown-item">CVP</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">哈希函数</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/introduction/" class="dropdown-item">哈希函数</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">MD5</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/md5/" class="dropdown-item">MD5</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SHA1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/sha1/" class="dropdown-item">SHA1</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">FNV</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/fnv/" class="dropdown-item">Fowler–Noll–Vo hash function</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Hash Attack</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/attack/" class="dropdown-item">Hash Attack</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../../hash/complex/" class="dropdown-item">综合题目</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../signature/introduction/" class="dropdown-item">数字签名</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../signature/rsa/" class="dropdown-item">RSA 数字签名</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ElGamal 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../signature/elgamal/" class="dropdown-item">ElGamal</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">DSA 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../signature/dsa/" class="dropdown-item">DSA</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">攻击思想总结</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../attack-summary/attack-mode/" class="dropdown-item">简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">中间相遇攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../attack-summary/meet-in-the-middle/" class="dropdown-item">中间相遇攻击 - MITM</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">比特攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../attack-summary/bit-attack/" class="dropdown-item">比特攻击</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">证书格式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../certificate/introduction/" class="dropdown-item">证书格式</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Development <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../development/introduction/" class="dropdown-item">Conflux应用开发入门</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">生态开发激励</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/incentive-guide/" class="dropdown-item">生态激励指南</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">开发工具及相关资源介绍</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/tools/" class="dropdown-item">开发工具</a>
</li>
            
<li>
    <a href="../../../../development/resources/" class="dropdown-item">开发资源</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ConfluxScan教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/apply-contract-fee/" class="dropdown-item">为合约申请Conflux赞助额度（合约代付）</a>
</li>
            
<li>
    <a href="../../../../development/address-NFT/" class="dropdown-item">NFT查看器教程</a>
</li>
            
<li>
    <a href="../../../../development/register-contract-and-token-display/" class="dropdown-item">如何在Scan上注册合约和代币展示</a>
</li>
            
<li>
    <a href="../../../../development/get-lp-token-address/" class="dropdown-item">查找LP代币的合约地址</a>
</li>
            
<li>
    <a href="../../../../development/internal-transaction/" class="dropdown-item">交易分析</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Portal钱包教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/portal/" class="dropdown-item">Portal安装配置步骤</a>
</li>
            
<li>
    <a href="../../../../development/portal-setting/" class="dropdown-item">Portal钱包常用功能解析</a>
</li>
            
<li>
    <a href="../../../../development/add-token-to-portal/" class="dropdown-item">添加CRC20代币到Portal的方法与步骤</a>
</li>
            
<li>
    <a href="../../../../development/portal-faucet/" class="dropdown-item">ConfluxPortal切换为测试网领取测试币教程</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Ecosystem <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../ecosystem/introduction/" class="dropdown-item">生态介绍</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Conflux基础生态教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../ecosystem/wcfx-cfx-exchange/" class="dropdown-item">WCFX与CFX代币互换</a>
</li>
            
<li>
    <a href="../../../../ecosystem/governance/" class="dropdown-item">Staking合约的质押与解质押</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">常见生态介绍及教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../ecosystem/tspace/" class="dropdown-item">Tspace 4.0 NFT平台</a>
</li>
            
<li>
    <a href="../../../../ecosystem/nft-box/" class="dropdown-item">NFTBox创新型资产交互平台</a>
</li>
            
<li>
    <a href="../../../../ecosystem/shuttleflow/" class="dropdown-item">Shuttleflow跨链工具</a>
</li>
            
<li>
    <a href="../../../../ecosystem/moonswap/" class="dropdown-item">moonswap生态</a>
</li>
            
<li>
    <a href="../../../../ecosystem/phantom/" class="dropdown-item">Phantom协议</a>
</li>
            
<li>
    <a href="../../../../ecosystem/dan/" class="dropdown-item">炼丹西游</a>
</li>
            
<li>
    <a href="../../../../ecosystem/guguo/" class="dropdown-item">古国序列</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Web <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../web/introduction/" class="dropdown-item">Web 简介</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SQL 注入</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/sqli/" class="dropdown-item">SQL 注入</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">XSS 跨站脚本攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/xss/" class="dropdown-item">XSS</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">CSRF 跨站请求伪造</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/csrf/" class="dropdown-item">CSRF</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SSRF 服务端请求伪造</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/ssrf/" class="dropdown-item">SSRF</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">PHP 代码审计</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/php/php/" class="dropdown-item">PHP 代码审计</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">BlockChain <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../blockchain/introduction/" class="dropdown-item">BlockChain Security Overview</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Ethereum Security</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../blockchain/ethereum/introduction/" class="dropdown-item">Ethereum Overview</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/basics/" class="dropdown-item">Ethereum Basics</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/selector-encoding/" class="dropdown-item">Function Selector and Argument Encoding</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/storage/" class="dropdown-item">Ethereum Storage</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/opcodes/" class="dropdown-item">Ethereum Opcodes</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Known Attacks</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/re-entrancy/" class="dropdown-item">Re-Entrancy</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/overflow-underflow/" class="dropdown-item">Integer Overflow and Underflow</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/randomness/" class="dropdown-item">Randomness</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/airdrop-hunting/" class="dropdown-item">Airdrop Hunting</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/shortaddress/" class="dropdown-item">Short Address Attack</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/delegatecall/" class="dropdown-item">Delegatecall</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/uninitialized-storage-pointer/" class="dropdown-item">Uninitialized Storage Pointer</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/arbitrarywrite/" class="dropdown-item">Arbitrary Writing</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/create2/" class="dropdown-item">CREATE2</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/jump-oriented-programming/" class="dropdown-item">Jump Oriented Programming</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../../../blockchain/ethereum/reverse/" class="dropdown-item">Smart Contract Reverse</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/challenges/" class="dropdown-item">区块链比赛题目</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/resources/" class="dropdown-item">学习资源</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Public Blockchain Security</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../blockchain/publicblockchain/introduction/" class="dropdown-item">Public Blockchain Security Overview</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">NFT <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../nft/introduction/" class="dropdown-item">初识NFT</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../rsa_theory/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../rsa_e_attack/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/conflux-wiki/conflux-wiki/blob/master/docs/zh/docs/crypto/asymmetric/rsa/rsa_module_attack.md" class="nav-link">Edit on conflux-wiki/conflux-wiki</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#_1" class="nav-link">模数相关攻击</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#n" class="nav-link">暴力分解 N</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#p-q-n" class="nav-link">p &amp; q 不当分解 N</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_5" class="nav-link">模不互素</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_7" class="nav-link">共模攻击</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_10" class="nav-link">题目</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="_1">模数相关攻击<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="n">暴力分解 N<a class="headerlink" href="#n" title="Permanent link">&para;</a></h2>
<h3 id="_2">攻击条件<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>在 N 的比特位数小于 512 的时候，可以采用大整数分解的策略获取 p 和 q。</p>
<h3 id="jarvisoj-easy-rsa">JarvisOJ - Easy RSA<a class="headerlink" href="#jarvisoj-easy-rsa" title="Permanent link">&para;</a></h3>
<p>这里我们以 "JarvisOJ - Easy RSA" 为例进行介绍，题目如下</p>
<blockquote>
<p>还记得 veryeasy RSA 吗？是不是不难？那继续来看看这题吧，这题也不难。<br />
已知一段 RSA 加密的信息为：0xdc2eeeb2782c 且已知加密所用的公钥：<br />
N=322831561921859 e = 23<br />
请解密出明文，提交时请将数字转化为 ascii 码提交<br />
比如你解出的明文是 0x6162，那么请提交字符串 ab<br />
提交格式：<code>PCTF{明文字符串}</code></p>
</blockquote>
<p>可以看出，我们的 N 比较小，这里我们直接使用 factordb 进行分解，可以得到</p>
<div class="arithmatex">
<div class="MathJax_Preview">
322831561921859 = 13574881 \times 23781539
</div>
<script type="math/tex; mode=display">
322831561921859 = 13574881 \times 23781539
</script>
</div>
<p>进而我们简单编写程序如下</p>
<pre class="highlight"><code class="language-python">import gmpy2
p = 13574881
q = 23781539
n = p * q
e = 23
c = 0xdc2eeeb2782c
phin = (p - 1) * (q - 1)
d = gmpy2.invert(e, phin)
p = gmpy2.powmod(c, d, n)
tmp = hex(p)
print tmp, tmp[2:].decode('hex')</code></pre>
<p>结果如下</p>
<pre class="highlight"><code class="language-shell">➜  Jarvis OJ-Basic-easyRSA git:(master) ✗ python exp.py
0x33613559 3a5Y</code></pre>
<h2 id="p-q-n">p &amp; q 不当分解 N<a class="headerlink" href="#p-q-n" title="Permanent link">&para;</a></h2>
<h3 id="_3">攻击条件<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>当 RSA 中 p 和 q 选取不当时，我们也可以进行攻击。</p>
<h3 id="p-q">|p-q| 很大<a class="headerlink" href="#p-q" title="Permanent link">&para;</a></h3>
<p>当 p-q 很大时，一定存在某一个参数较小，这里我们假设为 p，那么我们可以通过穷举的方法对模数进行试除，从而分解模数，得到保密参数与明文信息。基本来说，不怎么可行。</p>
<h3 id="p-q_1">|p-q| 较小<a class="headerlink" href="#p-q_1" title="Permanent link">&para;</a></h3>
<p>首先</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\frac{(p+q)^2}{4}-n=\frac{(p+q)^2}{4}-pq=\frac{(p-q)^2}{4}
</div>
<script type="math/tex; mode=display">
\frac{(p+q)^2}{4}-n=\frac{(p+q)^2}{4}-pq=\frac{(p-q)^2}{4}
</script>
</div>
<p>既然 |p-q| 较小，那么 <span class="arithmatex"><span class="MathJax_Preview">\frac{(p-q)^2}{4}</span><script type="math/tex">\frac{(p-q)^2}{4}</script></span> 自然也比较小，进而 <span class="arithmatex"><span class="MathJax_Preview">\frac{(p+q)^2}{4}</span><script type="math/tex">\frac{(p+q)^2}{4}</script></span> 只是比 N 稍微大一点，所以 <span class="arithmatex"><span class="MathJax_Preview">\frac{p+q}{2}</span><script type="math/tex">\frac{p+q}{2}</script></span> 与 <span class="arithmatex"><span class="MathJax_Preview">\sqrt{n}</span><script type="math/tex">\sqrt{n}</script></span> 相近。那么我们可以按照如下方法来分解</p>
<ul>
<li>顺序检查 <span class="arithmatex"><span class="MathJax_Preview">\sqrt{n}</span><script type="math/tex">\sqrt{n}</script></span> 的每一个整数 x，直到找到一个 x 使得 <span class="arithmatex"><span class="MathJax_Preview">x^2-n</span><script type="math/tex">x^2-n</script></span> 是平方数，记为 <span class="arithmatex"><span class="MathJax_Preview">y^2</span><script type="math/tex">y^2</script></span></li>
<li>那么 <span class="arithmatex"><span class="MathJax_Preview">x^2-n=y^2</span><script type="math/tex">x^2-n=y^2</script></span>，进而根据平方差公式即可分解 N</li>
</ul>
<h3 id="p-1">p - 1 光滑<a class="headerlink" href="#p-1" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>光滑数(Smooth number)：指可以分解为小素数乘积的正整数</p>
</li>
<li>
<p>当<span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>是<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>的因数，并且<span class="arithmatex"><span class="MathJax_Preview">p-1</span><script type="math/tex">p-1</script></span>是光滑数，可以考虑使用<code>Pollard's p-1</code>算法来分解<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span></p>
</li>
<li>
<p>根据费马小定理有</p>
<div class="arithmatex">
<div class="MathJax_Preview">若p\nmid a,\ 则a^{p-1}\equiv 1\pmod{p}</div>
<script type="math/tex; mode=display">若p\nmid a,\ 则a^{p-1}\equiv 1\pmod{p}</script>
</div>
<p>则有</p>
<div class="arithmatex">
<div class="MathJax_Preview">a^{t(p-1)}\equiv 1^t \equiv 1\pmod{p}</div>
<script type="math/tex; mode=display">a^{t(p-1)}\equiv 1^t \equiv 1\pmod{p}</script>
</div>
<p>即</p>
<div class="arithmatex">
<div class="MathJax_Preview">a^{t(p-1)} - 1 = k*p</div>
<script type="math/tex; mode=display">a^{t(p-1)} - 1 = k*p</script>
</div>
</li>
<li>
<p>根据<code>Pollard's p-1</code>算法：</p>
<p>如果<span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>是一个<span class="arithmatex"><span class="MathJax_Preview">B-smooth\ number</span><script type="math/tex">B-smooth\ number</script></span>，那么则存在</p>
<div class="arithmatex">
<div class="MathJax_Preview">M = \prod_{q\le{B}}{q^{\lfloor\log_q{B}\rfloor}}</div>
<script type="math/tex; mode=display">M = \prod_{q\le{B}}{q^{\lfloor\log_q{B}\rfloor}}</script>
</div>
<p>使得</p>
<div class="arithmatex">
<div class="MathJax_Preview">(p-1)\mid M</div>
<script type="math/tex; mode=display">(p-1)\mid M</script>
</div>
<p>成立，则有</p>
<div class="arithmatex">
<div class="MathJax_Preview">\gcd{(a^{M}-1, N)}</div>
<script type="math/tex; mode=display">\gcd{(a^{M}-1, N)}</script>
</div>
<p>如果结果不为<span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span>或<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>，那么就已成功分解<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>。</p>
<p>因为我们只关心最后的gcd结果，同时<code>N</code>只包含两个素因子，则我们不需要计算<span class="arithmatex"><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>，考虑<span class="arithmatex"><span class="MathJax_Preview">n=2,3,\dots</span><script type="math/tex">n=2,3,\dots</script></span>，令<span class="arithmatex"><span class="MathJax_Preview">M = n!</span><script type="math/tex">M = n!</script></span>即可覆盖正确的<span class="arithmatex"><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>同时方便计算。</p>
</li>
<li>
<p>在具体计算中，可以代入降幂进行计算</p>
<div class="arithmatex">
<div class="MathJax_Preview">
a^{n!}\bmod{N}=\begin{cases}
    (a\bmod{N})^2\mod{N}&amp;n=2\\
    (a^{(n-1)!}\bmod{N})^n\mod{N}&amp;n\ge{3}
\end{cases}</div>
<script type="math/tex; mode=display">
a^{n!}\bmod{N}=\begin{cases}
    (a\bmod{N})^2\mod{N}&n=2\\
    (a^{(n-1)!}\bmod{N})^n\mod{N}&n\ge{3}
\end{cases}</script>
</div>
</li>
<li>
<p>Python代码实现</p>
<pre class="highlight"><code class="language-python">from gmpy2 import *
a = 2
n = 2
while True:
    a = powmod(a, n, N)
    res = gcd(a-1, N)
    if res != 1 and res != N:
        q = n // res
        d = invert(e, (res-1)*(q-1))
        m = powmod(c, d, N)
        print(m)
        break
    n += 1</code></pre>
</li>
</ul>
<h3 id="p-1_1">p + 1 光滑<a class="headerlink" href="#p-1_1" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>当<span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>是<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>的因数，并且<span class="arithmatex"><span class="MathJax_Preview">p+1</span><script type="math/tex">p+1</script></span>是光滑数，可以考虑使用<code>Williams's p+1</code>算法来分解<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span></p>
</li>
<li>
<p>已知<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>的因数<span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>，且<span class="arithmatex"><span class="MathJax_Preview">p+1</span><script type="math/tex">p+1</script></span>是一个光滑数</p>
<div class="arithmatex">
<div class="MathJax_Preview">
p = \left(\prod_{i=1}^k{q_i^{\alpha_i}}\right)+1
</div>
<script type="math/tex; mode=display">
p = \left(\prod_{i=1}^k{q_i^{\alpha_i}}\right)+1
</script>
</div>
<p><span class="arithmatex"><span class="MathJax_Preview">q_i</span><script type="math/tex">q_i</script></span>即第<span class="arithmatex"><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>个素因数且有<span class="arithmatex"><span class="MathJax_Preview">q_i^{\alpha_i}\le B_1</span><script type="math/tex">q_i^{\alpha_i}\le B_1</script></span>, 找到<span class="arithmatex"><span class="MathJax_Preview">\beta_i</span><script type="math/tex">\beta_i</script></span>使得让<span class="arithmatex"><span class="MathJax_Preview">q_i^{\beta_i}\le B_1</span><script type="math/tex">q_i^{\beta_i}\le B_1</script></span>且<span class="arithmatex"><span class="MathJax_Preview">q_i^{\beta_i+1}&gt; B_1</span><script type="math/tex">q_i^{\beta_i+1}> B_1</script></span>，然后令</p>
<div class="arithmatex">
<div class="MathJax_Preview">
R = \prod_{i=1}^k{q_i^{\beta_i}}
</div>
<script type="math/tex; mode=display">
R = \prod_{i=1}^k{q_i^{\beta_i}}
</script>
</div>
<p>显然有<span class="arithmatex"><span class="MathJax_Preview">p-1\mid R</span><script type="math/tex">p-1\mid R</script></span>且当<span class="arithmatex"><span class="MathJax_Preview">(N, a) = 1</span><script type="math/tex">(N, a) = 1</script></span>时有<span class="arithmatex"><span class="MathJax_Preview">a^{p-1}\equiv 1 \pmod{p}</span><script type="math/tex">a^{p-1}\equiv 1 \pmod{p}</script></span>，所以有<span class="arithmatex"><span class="MathJax_Preview">a^R\equiv 1\pmod{p}</span><script type="math/tex">a^R\equiv 1\pmod{p}</script></span>，即</p>
<div class="arithmatex">
<div class="MathJax_Preview">
    p\mid(N, a^R-1)
</div>
<script type="math/tex; mode=display">
    p\mid(N, a^R-1)
</script>
</div>
</li>
<li>
<p>令<span class="arithmatex"><span class="MathJax_Preview">P,Q</span><script type="math/tex">P,Q</script></span>为整数，<span class="arithmatex"><span class="MathJax_Preview">\alpha,\beta</span><script type="math/tex">\alpha,\beta</script></span>为方程<span class="arithmatex"><span class="MathJax_Preview">x^2-Px+Q=0</span><script type="math/tex">x^2-Px+Q=0</script></span>的根，定义如下类卢卡斯序列</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{aligned}
    U_n(P, Q) &amp;= (\alpha^n -\beta^n)/(\alpha - \beta)\\
    V_n(P, Q) &amp;= \alpha^n + \beta^n
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned}
    U_n(P, Q) &= (\alpha^n -\beta^n)/(\alpha - \beta)\\
    V_n(P, Q) &= \alpha^n + \beta^n
\end{aligned}
</script>
</div>
<p>同样有<span class="arithmatex"><span class="MathJax_Preview">\Delta = (\alpha - \beta)^2 = P^2-4Q</span><script type="math/tex">\Delta = (\alpha - \beta)^2 = P^2-4Q</script></span>，则有</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{cases}
    U_{n+1} &amp;= PU_n - QU_{n-1}\\
    V_{n+1} &amp;= PV_n - QV_{n-1}
\end{cases}\tag{2.2}
</div>
<script type="math/tex; mode=display">
\begin{cases}
    U_{n+1} &= PU_n - QU_{n-1}\\
    V_{n+1} &= PV_n - QV_{n-1}
\end{cases}\tag{2.2}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{cases}
    U_{2n} &amp;= V_nU_n\\
    V_{2n} &amp;= V_n^2 - 2Q^n
\end{cases}\tag{2.3}
</div>
<script type="math/tex; mode=display">
\begin{cases}
    U_{2n} &= V_nU_n\\
    V_{2n} &= V_n^2 - 2Q^n
\end{cases}\tag{2.3}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{cases}
    U_{2n-1} &amp;= U_n^2 - QU_{n-1}^2\\
    V_{2n-1} &amp;= V_nV_{n-1} - PQ^{n-1}
\end{cases}\tag{2.4}
</div>
<script type="math/tex; mode=display">
\begin{cases}
    U_{2n-1} &= U_n^2 - QU_{n-1}^2\\
    V_{2n-1} &= V_nV_{n-1} - PQ^{n-1}
\end{cases}\tag{2.4}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{cases}
    \Delta U_{n} &amp;= PV_n - 2QV_{n-1}\\
    V_{n} &amp;= PU_n - 2QU_{n-1}
\end{cases}\tag{2.5}
</div>
<script type="math/tex; mode=display">
\begin{cases}
    \Delta U_{n} &= PV_n - 2QV_{n-1}\\
    V_{n} &= PU_n - 2QU_{n-1}
\end{cases}\tag{2.5}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{cases}
    U_{m+n} &amp;= U_mU_{n+1} - QU_{m-1}U_n\\
    \Delta U_{m+n} &amp;= V_mV_{n+1} - QV_{m-1}V_n
\end{cases}\tag{2.6}
</div>
<script type="math/tex; mode=display">
\begin{cases}
    U_{m+n} &= U_mU_{n+1} - QU_{m-1}U_n\\
    \Delta U_{m+n} &= V_mV_{n+1} - QV_{m-1}V_n
\end{cases}\tag{2.6}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{cases}
    U_{n}(V_k(P, Q), Q^k) &amp;= U_{nk}(P, Q)/U_k(P, Q)\\
    V_{n}(V_k(P, Q), Q^k) &amp;= V_n(P, Q)
\end{cases}\tag{2.7}
</div>
<script type="math/tex; mode=display">
\begin{cases}
    U_{n}(V_k(P, Q), Q^k) &= U_{nk}(P, Q)/U_k(P, Q)\\
    V_{n}(V_k(P, Q), Q^k) &= V_n(P, Q)
\end{cases}\tag{2.7}
</script>
</div>
<p>同时我们有如果<span class="arithmatex"><span class="MathJax_Preview">(N, Q) = 1</span><script type="math/tex">(N, Q) = 1</script></span>且<span class="arithmatex"><span class="MathJax_Preview">P^{'}Q\equiv P^2-2Q\pmod{N}</span><script type="math/tex">P^{'}Q\equiv P^2-2Q\pmod{N}</script></span>，则有<span class="arithmatex"><span class="MathJax_Preview">P^{'}\equiv \alpha/\beta + \beta/\alpha</span><script type="math/tex">P^{'}\equiv \alpha/\beta + \beta/\alpha</script></span>以及<span class="arithmatex"><span class="MathJax_Preview">Q^{'}\equiv \alpha/\beta + \beta/\alpha = 1</span><script type="math/tex">Q^{'}\equiv \alpha/\beta + \beta/\alpha = 1</script></span>，即</p>
<div class="arithmatex">
<div class="MathJax_Preview">
U_{2m}(P, Q)\equiv PQ^{m-1}U_m(P^{'}, 1)\pmod{N}\tag{2.8}
</div>
<script type="math/tex; mode=display">
U_{2m}(P, Q)\equiv PQ^{m-1}U_m(P^{'}, 1)\pmod{N}\tag{2.8}
</script>
</div>
<p>根据扩展卢卡斯定理</p>
<blockquote>
<p>如果p是奇素数，<span class="arithmatex"><span class="MathJax_Preview">p\nmid Q</span><script type="math/tex">p\nmid Q</script></span>且勒让德符号<span class="arithmatex"><span class="MathJax_Preview">(\Delta/p) = \epsilon</span><script type="math/tex">(\Delta/p) = \epsilon</script></span>，则</p>
</blockquote>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{aligned}
U_{(p-\epsilon)m}(P, Q) &amp;\equiv 0\pmod{p}\\
V_{(p-\epsilon)m}(P, Q) &amp;\equiv 2Q^{m(1-\epsilon)/2}\pmod{p}    
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned}
U_{(p-\epsilon)m}(P, Q) &\equiv 0\pmod{p}\\
V_{(p-\epsilon)m}(P, Q) &\equiv 2Q^{m(1-\epsilon)/2}\pmod{p}    
\end{aligned}
</script>
</div>
</li>
<li>
<p><code>第一种情况</code>：已知N的因数p，且p+1是一个光滑数</p>
<div class="arithmatex">
<div class="MathJax_Preview">
p = \left(\prod_{i=1}^k{q_i^{\alpha_i}}\right)-1
</div>
<script type="math/tex; mode=display">
p = \left(\prod_{i=1}^k{q_i^{\alpha_i}}\right)-1
</script>
</div>
<p>有<span class="arithmatex"><span class="MathJax_Preview">p+1\mid R</span><script type="math/tex">p+1\mid R</script></span>，当<span class="arithmatex"><span class="MathJax_Preview">(Q, N)=1</span><script type="math/tex">(Q, N)=1</script></span>且<span class="arithmatex"><span class="MathJax_Preview">(\Delta/p) = -1</span><script type="math/tex">(\Delta/p) = -1</script></span>时有<span class="arithmatex"><span class="MathJax_Preview">p\mid U_R(P, Q)</span><script type="math/tex">p\mid U_R(P, Q)</script></span>，即<span class="arithmatex"><span class="MathJax_Preview">p\mid (U_R(P, Q), N)</span><script type="math/tex">p\mid (U_R(P, Q), N)</script></span></p>
<p>为了找到<span class="arithmatex"><span class="MathJax_Preview">U_R(P, Q)</span><script type="math/tex">U_R(P, Q)</script></span>，<code>Guy</code>和<code>Conway</code>提出可以使用如下公式</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{aligned}
    U_{2n-1} &amp;= U_n^2 - QU_n^2 - 1\\
    U_{2n} &amp;= U_n(PU_n - 2QU_{n-1})\\
    U_{2n+1} &amp;= PU_{2n} - QU_{2n-1}
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned}
    U_{2n-1} &= U_n^2 - QU_n^2 - 1\\
    U_{2n} &= U_n(PU_n - 2QU_{n-1})\\
    U_{2n+1} &= PU_{2n} - QU_{2n-1}
\end{aligned}
</script>
</div>
<p>但是上述公式值太大了，不便运算，我们可以考虑如下方法</p>
<p>如果<span class="arithmatex"><span class="MathJax_Preview">p \mid U_R(P, 1)</span><script type="math/tex">p \mid U_R(P, 1)</script></span>，根据<code>公式2.3</code>有<span class="arithmatex"><span class="MathJax_Preview">p\mid U_{2R}(P, Q)</span><script type="math/tex">p\mid U_{2R}(P, Q)</script></span>，所以根据<code>公式2.8</code>有<span class="arithmatex"><span class="MathJax_Preview">p \mid U_R(P^{'}, 1)</span><script type="math/tex">p \mid U_R(P^{'}, 1)</script></span>，设<span class="arithmatex"><span class="MathJax_Preview">Q=1</span><script type="math/tex">Q=1</script></span>，则有</p>
<div class="arithmatex">
<div class="MathJax_Preview">
V_{(p-\epsilon)m}(P, 1) \equiv 2\pmod{p}
</div>
<script type="math/tex; mode=display">
V_{(p-\epsilon)m}(P, 1) \equiv 2\pmod{p}
</script>
</div>
<p>即，如果<span class="arithmatex"><span class="MathJax_Preview">p\mid U_R(P, 1)</span><script type="math/tex">p\mid U_R(P, 1)</script></span>，则<span class="arithmatex"><span class="MathJax_Preview">p\mid(V_R(P, 1) -2)</span><script type="math/tex">p\mid(V_R(P, 1) -2)</script></span>.</p>
<p>第一种情况可以归纳为：</p>
<p>让<span class="arithmatex"><span class="MathJax_Preview">R = r_1r_2r_3\cdots r_m</span><script type="math/tex">R = r_1r_2r_3\cdots r_m</script></span>，同时找到<span class="arithmatex"><span class="MathJax_Preview">P_0</span><script type="math/tex">P_0</script></span>使得<span class="arithmatex"><span class="MathJax_Preview">(P_0^2-4, N) = 1</span><script type="math/tex">(P_0^2-4, N) = 1</script></span>，定义<span class="arithmatex"><span class="MathJax_Preview">V_n(P) = V_n(P, 1), U_n(P) = U_n(P, 1)</span><script type="math/tex">V_n(P) = V_n(P, 1), U_n(P) = U_n(P, 1)</script></span>且</p>
<div class="arithmatex">
<div class="MathJax_Preview">
P_j \equiv V_{r_j}(P_{j-1})\pmod{N}(j = 1,2,3,\dots,m)
</div>
<script type="math/tex; mode=display">
P_j \equiv V_{r_j}(P_{j-1})\pmod{N}(j = 1,2,3,\dots,m)
</script>
</div>
<p>根据<code>公式2.7</code>，有</p>
<div class="arithmatex">
<div class="MathJax_Preview">
P_m \equiv V_R(P_0)\pmod{N}\tag{3.1}
</div>
<script type="math/tex; mode=display">
P_m \equiv V_R(P_0)\pmod{N}\tag{3.1}
</script>
</div>
<p>要计算<span class="arithmatex"><span class="MathJax_Preview">V_r = V_r(P)</span><script type="math/tex">V_r = V_r(P)</script></span>可以用如下公式</p>
<p>根据<code>公式2.2</code>，<code>公式2.3</code>，<code>公式2.4</code>有</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{cases}
    V_{2f-1}&amp;\equiv V_fV_{f-1}-P\\
    V_{2f}&amp;\equiv V_f^2 - 2\\
    V_{2f+1}&amp;\equiv PV_f^2-V_fV_{f-1}-P\pmod(N)
\end{cases}
</div>
<script type="math/tex; mode=display">
\begin{cases}
    V_{2f-1}&\equiv V_fV_{f-1}-P\\
    V_{2f}&\equiv V_f^2 - 2\\
    V_{2f+1}&\equiv PV_f^2-V_fV_{f-1}-P\pmod(N)
\end{cases}
</script>
</div>
<p>令</p>
<div class="arithmatex">
<div class="MathJax_Preview">
r = \sum_{i=0}^t{b_t2^{t-i}}\ \ \ \ (b_i=0,1)
</div>
<script type="math/tex; mode=display">
r = \sum_{i=0}^t{b_t2^{t-i}}\ \ \ \ (b_i=0,1)
</script>
</div>
<p><span class="arithmatex"><span class="MathJax_Preview">f_0=1, f_{k+1}=2f_k+b_{k+1}</span><script type="math/tex">f_0=1, f_{k+1}=2f_k+b_{k+1}</script></span>，则<span class="arithmatex"><span class="MathJax_Preview">f_t=r</span><script type="math/tex">f_t=r</script></span>，同样<span class="arithmatex"><span class="MathJax_Preview">V_0(P) = 2, V_1(P) = P</span><script type="math/tex">V_0(P) = 2, V_1(P) = P</script></span>，则最终公式为</p>
<div class="arithmatex">
<div class="MathJax_Preview">
(V_{f_{k+1}}, V_{f_{k+1}-1}) = \begin{cases}
(V_{2f_k}, V_{2f_k-1})\ \ \ \ if\ b_{k+1}=0\\
(V_{2f_k+1}, V_{2f_k})\ \ \ \ if\ b_{k+1}=1
\end{cases}
</div>
<script type="math/tex; mode=display">
(V_{f_{k+1}}, V_{f_{k+1}-1}) = \begin{cases}
(V_{2f_k}, V_{2f_k-1})\ \ \ \ if\ b_{k+1}=0\\
(V_{2f_k+1}, V_{2f_k})\ \ \ \ if\ b_{k+1}=1
\end{cases}
</script>
</div>
</li>
<li>
<p><code>第二种情况</code>：已知p+1是一个光滑数</p>
<div class="arithmatex">
<div class="MathJax_Preview">
p = s\left(\prod_{i=1}^k{q_i^{\alpha_i}}\right)-1
</div>
<script type="math/tex; mode=display">
p = s\left(\prod_{i=1}^k{q_i^{\alpha_i}}\right)-1
</script>
</div>
<p>当<span class="arithmatex"><span class="MathJax_Preview">s</span><script type="math/tex">s</script></span>是素数，且<span class="arithmatex"><span class="MathJax_Preview">B_1&lt;s\le B_2</span><script type="math/tex">B_1<s\le B_2</script></span>，有<span class="arithmatex"><span class="MathJax_Preview">p\mid(a_m^s-1, N)，</span><script type="math/tex">p\mid(a_m^s-1, N)，</script></span>定义<span class="arithmatex"><span class="MathJax_Preview">s_j</span><script type="math/tex">s_j</script></span>和<span class="arithmatex"><span class="MathJax_Preview">2d_j</span><script type="math/tex">2d_j</script></span></p>
<div class="arithmatex">
<div class="MathJax_Preview">
2d_j = s_j+1-s_j
</div>
<script type="math/tex; mode=display">
2d_j = s_j+1-s_j
</script>
</div>
<p>如果<span class="arithmatex"><span class="MathJax_Preview">(\Delta/p) = -1</span><script type="math/tex">(\Delta/p) = -1</script></span>且<span class="arithmatex"><span class="MathJax_Preview">p\nmid P_m-2</span><script type="math/tex">p\nmid P_m-2</script></span>，则根据<code>公式2.7</code>和<code>公式3.1</code>有<span class="arithmatex"><span class="MathJax_Preview">p\mid(U_s(P_m), N)</span><script type="math/tex">p\mid(U_s(P_m), N)</script></span>。</p>
<p>令<span class="arithmatex"><span class="MathJax_Preview">U[n] \equiv U_n(P_m), V[n]\equiv V_n(P_m)\pmod{N}</span><script type="math/tex">U[n] \equiv U_n(P_m), V[n]\equiv V_n(P_m)\pmod{N}</script></span>，计算<span class="arithmatex"><span class="MathJax_Preview">U[2d_j-1], U[2d_j], U[2d_j+1]</span><script type="math/tex">U[2d_j-1], U[2d_j], U[2d_j+1]</script></span>通过</p>
<div class="arithmatex">
<div class="MathJax_Preview">U[0] = 0, U[1] = 1, U[n+1] = P_mU[n] - U[n-1]</div>
<script type="math/tex; mode=display">U[0] = 0, U[1] = 1, U[n+1] = P_mU[n] - U[n-1]</script>
</div>
<p>计算</p>
<div class="arithmatex">
<div class="MathJax_Preview">
T[s_i] \equiv \Delta U_{s_i}(P_m) = \Delta U_{s_iR}(P_0)/U_R(P_0)\pmod{N}
</div>
<script type="math/tex; mode=display">
T[s_i] \equiv \Delta U_{s_i}(P_m) = \Delta U_{s_iR}(P_0)/U_R(P_0)\pmod{N}
</script>
</div>
<p>通过<code>公式2.6</code>，<code>公式2.7</code>和<code>公式3.1</code>有</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{cases}
    T[s_1]&amp;\equiv P_mV[s_1]-2V[s_1-1]\\
    T[s_1-1]&amp;\equiv 2V[s_1]-P_mV[s_1-1]\pmod{N}
\end{cases}
</div>
<script type="math/tex; mode=display">
\begin{cases}
    T[s_1]&\equiv P_mV[s_1]-2V[s_1-1]\\
    T[s_1-1]&\equiv 2V[s_1]-P_mV[s_1-1]\pmod{N}
\end{cases}
</script>
</div>
<p>即</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{cases}
    T[s_{i+1}]&amp;\equiv T[s_i]U[2d_i+1]-T[s_i-1]U[2d_i]\\
    T[s_{i+1}-1]&amp;\equiv T[s_i]U[2d_i]-T[s_i-1]U[2d_i-1]\pmod{N}
\end{cases}
</div>
<script type="math/tex; mode=display">
\begin{cases}
    T[s_{i+1}]&\equiv T[s_i]U[2d_i+1]-T[s_i-1]U[2d_i]\\
    T[s_{i+1}-1]&\equiv T[s_i]U[2d_i]-T[s_i-1]U[2d_i-1]\pmod{N}
\end{cases}
</script>
</div>
<p>计算<span class="arithmatex"><span class="MathJax_Preview">T[s_i], i=1,2,3\dots</span><script type="math/tex">T[s_i], i=1,2,3\dots</script></span>，然后计算</p>
<div class="arithmatex">
<div class="MathJax_Preview">
H_t = (\prod_{i=0}^c{T[s_{i+t}], N})
</div>
<script type="math/tex; mode=display">
H_t = (\prod_{i=0}^c{T[s_{i+t}], N})
</script>
</div>
<p>其中<span class="arithmatex"><span class="MathJax_Preview">t = 1, c+1, 2c+1, \dots, c[B_2/c]+1</span><script type="math/tex">t = 1, c+1, 2c+1, \dots, c[B_2/c]+1</script></span>，我们有<span class="arithmatex"><span class="MathJax_Preview">p\mid H_i</span><script type="math/tex">p\mid H_i</script></span>当<span class="arithmatex"><span class="MathJax_Preview">(\Delta/p)=-1</span><script type="math/tex">(\Delta/p)=-1</script></span></p>
</li>
<li>
<p>python代码实现</p>
<pre class="highlight"><code class="language-python">def mlucas(v, a, n):
    """ Helper function for williams_pp1().  Multiplies along a Lucas sequence modulo n. """
    v1, v2 = v, (v**2 - 2) % n
    for bit in bin(a)[3:]: v1, v2 = ((v1**2 - 2) % n, (v1*v2 - v) % n) if bit == "0" else ((v1*v2 - v) % n, (v2**2 - 2) % n)
    return v1

for v in count(1):
    for p in primegen():
        e = ilog(isqrt(n), p)
        if e == 0: break
        for _ in xrange(e): v = mlucas(v, p, n)
        g = gcd(v-2, n)
        if 1 &lt; g &lt; n: return g # g|n
        if g == n: break</code></pre>
</li>
</ul>
<h3 id="2017-seccon-very-smooth">2017 SECCON very smooth<a class="headerlink" href="#2017-seccon-very-smooth" title="Permanent link">&para;</a></h3>
<p>该程序给了一个 HTTPS 加密的流量包，首先从其中拿到证书</p>
<pre class="highlight"><code class="language-shell">➜  2017_SECCON_verysmooth git:(master) binwalk -e s.pcap      

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
2292          0x8F4           Certificate in DER format (x509 v3), header length: 4, sequence length: 467
4038          0xFC6           Certificate in DER format (x509 v3), header length: 4, sequence length: 467
5541          0x15A5          Certificate in DER format (x509 v3), header length: 4, sequence length: 467

➜  2017_SECCON_verysmooth git:(master) ls
s.pcap  _s.pcap.extracted  very_smooth.zip</code></pre>
<p>这里分别查看三个证书，三个模数都一样，这里只给一个例子</p>
<pre class="highlight"><code>➜  _s.pcap.extracted git:(master) openssl x509 -inform DER -in FC6.crt  -pubkey -text -modulus -noout 
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDVRqqCXPYd6Xdl9GT7/kiJrYvy
8lohddAsi28qwMXCe2cDWuwZKzdB3R9NEnUxsHqwEuuGJBwJwIFJnmnvWurHjcYj
DUddp+4X8C9jtvCaLTgd+baSjo2eB0f+uiSL/9/4nN+vR3FliRm2mByeFCjppTQl
yioxCqbXYIMxGO4NcQIDAQAB
-----END PUBLIC KEY-----
Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number: 11640506567126718943 (0xa18b630c7b3099df)
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: C=JP, ST=Kawasaki, O=SRL
        Validity
            Not Before: Oct  8 02:47:17 2017 GMT
            Not After : Oct  8 02:47:17 2018 GMT
        Subject: C=JP, ST=Kawasaki, O=SRL
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (1024 bit)
                Modulus:
                    00:d5:46:aa:82:5c:f6:1d:e9:77:65:f4:64:fb:fe:
                    48:89:ad:8b:f2:f2:5a:21:75:d0:2c:8b:6f:2a:c0:
                    c5:c2:7b:67:03:5a:ec:19:2b:37:41:dd:1f:4d:12:
                    75:31:b0:7a:b0:12:eb:86:24:1c:09:c0:81:49:9e:
                    69:ef:5a:ea:c7:8d:c6:23:0d:47:5d:a7:ee:17:f0:
                    2f:63:b6:f0:9a:2d:38:1d:f9:b6:92:8e:8d:9e:07:
                    47:fe:ba:24:8b:ff:df:f8:9c:df:af:47:71:65:89:
                    19:b6:98:1c:9e:14:28:e9:a5:34:25:ca:2a:31:0a:
                    a6:d7:60:83:31:18:ee:0d:71
                Exponent: 65537 (0x10001)
    Signature Algorithm: sha256WithRSAEncryption
         78:92:11:fb:6c:e1:7a:f7:2a:33:b8:8b:08:a7:f7:5b:de:cf:
         62:0b:a0:ed:be:d0:69:88:38:93:94:9d:05:41:73:bd:7e:b3:
         32:ec:8e:10:bc:3a:62:b0:56:c7:c1:3f:60:66:a7:be:b9:46:
         f7:46:22:6a:f3:5a:25:d5:66:94:57:0e:fc:b5:16:33:05:1c:
         6f:f5:85:74:57:a4:a0:c6:ce:4f:fd:64:53:94:a9:83:b8:96:
         bf:5b:a7:ee:8b:1e:48:a7:d2:43:06:0e:4f:5a:86:62:69:05:
         e2:c0:bd:4e:89:c9:af:04:4a:77:a2:34:86:6a:b8:d2:3b:32:
         b7:39
Modulus=D546AA825CF61DE97765F464FBFE4889AD8BF2F25A2175D02C8B6F2AC0C5C27B67035AEC192B3741DD1F4D127531B07AB012EB86241C09C081499E69EF5AEAC78DC6230D475DA7EE17F02F63B6F09A2D381DF9B6928E8D9E0747FEBA248BFFDFF89CDFAF4771658919B6981C9E1428E9A53425CA2A310AA6D760833118EE0D71</code></pre>
<p>可以看出模数只有 1024 比特。而且，根据题目名 very smooth，应该是其中一个因子比较 smooth，这里我们利用 primefac 分别尝试 Pollard's p − 1 与 Williams's p + 1 算法，如下</p>
<pre class="highlight"><code class="language-shell">➜  _s.pcap.extracted git:(master) python -m primefac -vs -m=p+1  149767527975084886970446073530848114556615616489502613024958495602726912268566044330103850191720149622479290535294679429142532379851252608925587476670908668848275349192719279981470382501117310509432417895412013324758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897

149767527975084886970446073530848114556615616489502613024958495602726912268566044330103850191720149622479290535294679429142532379851252608925587476670908668848275349192719279981470382501117310509432417895412013324758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897: p+1 11807485231629132025602991324007150366908229752508016230400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001 12684117323636134264468162714319298445454220244413621344524758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897
Z309  =  P155 x P155  =  11807485231629132025602991324007150366908229752508016230400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001 x 12684117323636134264468162714319298445454220244413621344524758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897</code></pre>
<p>可以发现当使用 Williams's <em>p</em> + 1 算法时，就直接分解出来了。按道理这个因子是 p-1 似乎更光滑，但是却并不能使用 Pollard's p − 1 算法分解，这里进行进一步的测试</p>
<pre class="highlight"><code class="language-shell">➜  _s.pcap.extracted git:(master) python -m primefac -vs 1180748523162913202560299132400715036690822975250801623040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002

1180748523162913202560299132400715036690822975250801623040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002: 2 7 43 503 761429 5121103123294685745276806480148867612214394022184063853387799606010231770631857868979139305712805242051823263337587909550709296150544706624823
Z154  =  P1 x P1 x P2 x P3 x P6 x P142  =  2 x 7 x 43 x 503 x 761429 x 5121103123294685745276806480148867612214394022184063853387799606010231770631857868979139305712805242051823263337587909550709296150544706624823

➜  _s.pcap.extracted git:(master) python -m primefac -vs 1180748523162913202560299132400715036690822975250801623040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 

1180748523162913202560299132400715036690822975250801623040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000: 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5
Z154  =  P1^185 x P1^62 x P1^97  =  2^185 x 3^62 x 5^97</code></pre>
<p>可以看出，对于 p-1 确实有很多小因子，但是个数太多，这就会使得进行枚举的时候出现指数爆炸的情况，因此没有分解出来。</p>
<p>进而根据分解出来的数构造私钥</p>
<pre class="highlight"><code class="language-python">from Crypto.PublicKey import RSA
import gmpy2


def main():
    n = 149767527975084886970446073530848114556615616489502613024958495602726912268566044330103850191720149622479290535294679429142532379851252608925587476670908668848275349192719279981470382501117310509432417895412013324758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897L
    p = 11807485231629132025602991324007150366908229752508016230400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001L
    q = 12684117323636134264468162714319298445454220244413621344524758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897L
    e = 65537L
    priv = RSA.construct((n, e, long(gmpy2.invert(e, (p - 1) * (q - 1)))))
    open('private.pem', 'w').write(priv.exportKey('PEM'))


main()</code></pre>
<p>最后，将私钥导入到 wireshark 中即可得到明文（Edit -&gt; Preferences -&gt; Protocols -&gt; SSL -&gt; RSA Key List）。</p>
<pre class="highlight"><code class="language-html">&lt;html&gt;
&lt;head&gt;&lt;title&gt;Very smooth&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;
Answer: One of these primes is very smooth.
&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h3 id="_4">扩展<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>关于更多的一些分解模数 N 的方法可以参考 <a href="https://en.wikipedia.org/wiki/Integer_factorization">https://en.wikipedia.org/wiki/Integer_factorization</a>。</p>
<h2 id="_5">模不互素<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="_6">攻击原理<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>当存在两个公钥的 N 不互素时，我们显然可以直接对这两个数求最大公因数，然后直接获得 p，q，进而获得相应的私钥。</p>
<h3 id="sctf-rsa2">SCTF RSA2<a class="headerlink" href="#sctf-rsa2" title="Permanent link">&para;</a></h3>
<p>这里我们以 SCTF rsa2 为例进行介绍。直接打开 pcap 包，发现有一堆的消息，包含 N 和 e，然后试了试不同的 N 是否互素，我试了前两个</p>
<pre class="highlight"><code class="language-python">import gmpy2
n1 = 20823369114556260762913588844471869725762985812215987993867783630051420241057912385055482788016327978468318067078233844052599750813155644341123314882762057524098732961382833215291266591824632392867716174967906544356144072051132659339140155889569810885013851467056048003672165059640408394953573072431523556848077958005971533618912219793914524077919058591586451716113637770245067687598931071827344740936982776112986104051191922613616045102859044234789636058568396611030966639561922036712001911238552391625658741659644888069244729729297927279384318252191421446283531524990762609975988147922688946591302181753813360518031
n2 = 19083821613736429958432024980074405375408953269276839696319265596855426189256865650651460460079819368923576109723079906759410116999053050999183058013281152153221170931725172009360565530214701693693990313074253430870625982998637645030077199119183041314493288940590060575521928665131467548955951797198132001987298869492894105525970519287000775477095816742582753228905458466705932162641076343490086247969277673809512472546919489077884464190676638450684714880196854445469562733561723325588433285405495368807600668761929378526978417102735864613562148766250350460118131749533517869691858933617013731291337496943174343464943
print gmpy2.gcd(n1, n2)</code></pre>
<p>结果发现竟然不互素。</p>
<pre class="highlight"><code class="language-shell">➜  scaf-rsa2 git:(master) ✗ python exp.py
122281872221091773923842091258531471948886120336284482555605167683829690073110898673260712865021244633908982705290201598907538975692920305239961645109897081011524485706755794882283892011824006117276162119331970728229108731696164377808170099285659797066904706924125871571157672409051718751812724929680249712137</code></pre>
<p>那么我们就可以直接来解密了，这里我们利用第一对公钥密码。代码如下</p>
<pre class="highlight"><code class="language-python">from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_v1_5, PKCS1_OAEP
import gmpy2
from base64 import b64decode
n1 = 20823369114556260762913588844471869725762985812215987993867783630051420241057912385055482788016327978468318067078233844052599750813155644341123314882762057524098732961382833215291266591824632392867716174967906544356144072051132659339140155889569810885013851467056048003672165059640408394953573072431523556848077958005971533618912219793914524077919058591586451716113637770245067687598931071827344740936982776112986104051191922613616045102859044234789636058568396611030966639561922036712001911238552391625658741659644888069244729729297927279384318252191421446283531524990762609975988147922688946591302181753813360518031
n2 = 19083821613736429958432024980074405375408953269276839696319265596855426189256865650651460460079819368923576109723079906759410116999053050999183058013281152153221170931725172009360565530214701693693990313074253430870625982998637645030077199119183041314493288940590060575521928665131467548955951797198132001987298869492894105525970519287000775477095816742582753228905458466705932162641076343490086247969277673809512472546919489077884464190676638450684714880196854445469562733561723325588433285405495368807600668761929378526978417102735864613562148766250350460118131749533517869691858933617013731291337496943174343464943
p1 = gmpy2.gcd(n1, n2)
q1 = n1 / p1
e = 65537
phin = (p1 - 1) * (q1 - 1)
d = gmpy2.invert(e, phin)
cipher = 0x68d5702b70d18238f9d4a3ac355b2a8934328250efd4efda39a4d750d80818e6fe228ba3af471b27cc529a4b0bef70a2598b80dd251b15952e6a6849d366633ed7bb716ed63c6febd4cd0621b0c4ebfe5235de03d4ee016448de1afbbe61144845b580eed8be8127a8d92b37f9ef670b3cdd5af613c76f58ca1a9f6f03f1bc11addba30b61bb191efe0015e971b8f78375faa257a60b355050f6435d94b49eab07075f40cb20bb8723d02f5998d5538e8dafc80cc58643c91f6c0868a7a7bf3bf6a9b4b6e79e0a80e89d430f0c049e1db4883c50db066a709b89d74038c34764aac286c36907b392bc299ab8288f9d7e372868954a92cdbf634678f7294096c7
plain = gmpy2.powmod(cipher, d, n1)
plain = hex(plain)[2:]
if len(plain) % 2 != 0:
    plain = '0' + plain
print plain.decode('hex')</code></pre>
<p>最后解密如下</p>
<pre class="highlight"><code class="language-shell">➜  scaf-rsa2 git:(master) ✗ python exp.py       
sH1R3_PRlME_1N_rsA_iS_4ulnEra5le</code></pre>
<p>解压压缩包即可。</p>
<h2 id="_7">共模攻击<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<h3 id="_8">攻击条件<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>当两个用户使用相同的模数 N、不同的私钥时，加密同一明文消息时即存在共模攻击。</p>
<h3 id="_9">攻击原理<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>设两个用户的公钥分别为 <span class="arithmatex"><span class="MathJax_Preview">e_1</span><script type="math/tex">e_1</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">e_2</span><script type="math/tex">e_2</script></span>，且两者互质。明文消息为 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>，密文分别为：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
c_1 = m^{e_1}\bmod N \\
c_2 = m^{e_2}\bmod N
</div>
<script type="math/tex; mode=display">
c_1 = m^{e_1}\bmod N \\
c_2 = m^{e_2}\bmod N
</script>
</div>
<p>当攻击者截获 <span class="arithmatex"><span class="MathJax_Preview">c_1</span><script type="math/tex">c_1</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">c_2</span><script type="math/tex">c_2</script></span> 后，就可以恢复出明文。用扩展欧几里得算法求出 <span class="arithmatex"><span class="MathJax_Preview">re_1+se_2=1\bmod n</span><script type="math/tex">re_1+se_2=1\bmod n</script></span> 的两个整数 <span class="arithmatex"><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">s</span><script type="math/tex">s</script></span>，由此可得：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{align*}
c_{1}^{r}c_{2}^{s} &amp;\equiv m^{re_1}m^{se_2}\bmod n\\
&amp;\equiv m^{(re_1+se_2)} \bmod n\\
&amp;\equiv m\bmod n
\end{align*}
</div>
<script type="math/tex; mode=display">
\begin{align*}
c_{1}^{r}c_{2}^{s} &\equiv m^{re_1}m^{se_2}\bmod n\\
&\equiv m^{(re_1+se_2)} \bmod n\\
&\equiv m\bmod n
\end{align*}
</script>
</div>
<h3 id="xman">XMan 一期夏令营课堂练习<a class="headerlink" href="#xman" title="Permanent link">&para;</a></h3>
<p>题目描述：</p>
<pre class="highlight"><code>{6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249,773}

{6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249,839}

message1=3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349

message2=5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</code></pre>
<blockquote>
<p>题目来源：XMan 一期夏令营课堂练习 </p>
</blockquote>
<p>可以看出两个公钥的 N 是一样的，并且两者的 e 互素。写一个脚本跑一下：</p>
<pre class="highlight"><code class="language-python">import gmpy2
n = 6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249
e1 = 773

e2 = 839

message1 = 3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349

message2 = 5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535
# s &amp; t
gcd, s, t = gmpy2.gcdext(e1, e2)
if s &lt; 0:
    s = -s
    message1 = gmpy2.invert(message1, n)
if t &lt; 0:
    t = -t
    message2 = gmpy2.invert(message2, n)
plain = gmpy2.powmod(message1, s, n) * gmpy2.powmod(message2, t, n) % n
print plain</code></pre>
<p>得到</p>
<pre class="highlight"><code class="language-shell">➜  Xman-1-class-exercise git:(master) ✗ python exp.py
1021089710312311910410111011910111610410511010710511610511511211111511510598108101125</code></pre>
<p>这时候需要考虑当时明文是如何转化为这个数字了，一般来说是 16 进制转换，ASCII 字符转换，或者 Base64 解密。这个应该是 ASCII 字符转换，进而我们使用如下代码得到 flag</p>
<pre class="highlight"><code class="language-python">i = 0
flag = ""
plain = str(plain)
while i &lt; len(plain):
    if plain[i] == '1':
        flag += chr(int(plain[i:i + 3]))
        i += 3
    else:
        flag += chr(int(plain[i:i + 2]))
        i += 2
print flag</code></pre>
<p>这里之所以使用 1 来判断是否为三位长度，是因为 flag 一般都是明文字符，而 1 开头的长度为 1 或者 2 的数字，一般都是不可见字符。</p>
<p>flag</p>
<pre class="highlight"><code class="language-shell">➜  Xman-1-class-exercise git:(master) ✗ python exp.py
flag{whenwethinkitispossible}</code></pre>
<h2 id="_10">题目<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<ul>
<li>Jarvis OJ very hard RSA</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2020 - 2021 Conflux Wiki Team</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
        <script src="../../../../static/js/extra.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
