<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Conflux Wiki Team">
        <link rel="canonical" href="https://conflux-wiki.github.io/crypto/asymmetric/rsa/rsa_theory/">
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>RSA 介绍 - Conflux Wiki</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../../../static/css/extra.css" rel="stylesheet">

        <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">Conflux Wiki</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Start <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../.." class="dropdown-item">简介</a>
</li>
                                    
<li>
    <a href="../../../../usage/" class="dropdown-item">如何使用 Conflux Wiki</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">贡献指南</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../contribute/before-contributing/" class="dropdown-item">贡献之前</a>
</li>
            
<li>
    <a href="../../../../contribute/basic-contribute-approach/" class="dropdown-item">基本贡献方式</a>
</li>
            
<li>
    <a href="../../../../contribute/documentation-requirement/" class="dropdown-item">贡献文档要求</a>
</li>
            
<li>
    <a href="../../../../contribute/translation/" class="dropdown-item">翻译</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../../../discussion/" class="dropdown-item">讨论交流</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Introduction <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../introduction/history/" class="dropdown-item">区块链 历史</a>
</li>
                                    
<li>
    <a href="../../../../introduction/link/" class="dropdown-item">Conflux相关链接</a>
</li>
                                    
<li>
    <a href="../../../../introduction/highlight-time/" class="dropdown-item">重要时刻</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Crypto <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../introduction/" class="dropdown-item">密码学简介</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">基础数学知识</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../basic/introduction/" class="dropdown-item">基础数学知识</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">古典密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../classical/introduction/" class="dropdown-item">古典密码简介</a>
</li>
            
<li>
    <a href="../../../classical/monoalphabetic/" class="dropdown-item">单表代换加密</a>
</li>
            
<li>
    <a href="../../../classical/polyalphabetic/" class="dropdown-item">多表代换加密</a>
</li>
            
<li>
    <a href="../../../classical/others/" class="dropdown-item">其它类型加密</a>
</li>
            
<li>
    <a href="../../../classical/summary/" class="dropdown-item">总结</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../streamcipher/intro/" class="dropdown-item">流密码</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">伪随机数生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../streamcipher/prng/intro/" class="dropdown-item">伪随机数生成器介绍</a>
</li>
            
<li>
    <a href="../../../streamcipher/prng/csprng/" class="dropdown-item">密码安全伪随机数生成器</a>
</li>
            
<li>
    <a href="../../../streamcipher/prng/problem/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">线性同余生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../streamcipher/lcg/intro/" class="dropdown-item">线性同余生成器</a>
</li>
            
<li>
    <a href="../../../streamcipher/lcg/challenge/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">反馈移位寄存器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../streamcipher/fsr/intro/" class="dropdown-item">反馈移位寄存器</a>
</li>
            
<li>
    <a href="../../../streamcipher/fsr/lfsr/" class="dropdown-item">线性反馈移位寄存器 - LFSR</a>
</li>
            
<li>
    <a href="../../../streamcipher/fsr/nfsr/" class="dropdown-item">非线性反馈移位寄存器</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">特殊流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../streamcipher/special/rc4/" class="dropdown-item">RC4</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">块加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/introduction/" class="dropdown-item">块加密</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ARX</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/arx-operations/" class="dropdown-item">ARX: Add-Rotate-Xor</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">DES</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/des/" class="dropdown-item">DES</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">IDEA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/idea/" class="dropdown-item">IDEA</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">AES</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/aes/" class="dropdown-item">AES</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Simon and Speck</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/simon-speck/" class="dropdown-item">Simon and Speck Block Ciphers</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">分组模式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/mode/introduction/" class="dropdown-item">分组模式</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/padding/" class="dropdown-item">填充方式</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/ecb/" class="dropdown-item">ECB</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/cbc/" class="dropdown-item">CBC</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/pcbc/" class="dropdown-item">PCBC</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/cfb/" class="dropdown-item">CFB</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/ofb/" class="dropdown-item">OFB</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/ctr/" class="dropdown-item">CTR</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/padding-oracle-attack/" class="dropdown-item">Padding Oracle Attack</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">非对称加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../introduction/" class="dropdown-item">介绍</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="./" class="dropdown-item active">RSA 介绍</a>
</li>
            
<li>
    <a href="../rsa_module_attack/" class="dropdown-item">模数相关攻击</a>
</li>
            
<li>
    <a href="../rsa_e_attack/" class="dropdown-item">公钥指数相关攻击</a>
</li>
            
<li>
    <a href="../rsa_d_attack/" class="dropdown-item">私钥 d 相关攻击</a>
</li>
            
<li>
    <a href="../rsa_coppersmith_attack/" class="dropdown-item">Coppersmith 相关攻击</a>
</li>
            
<li>
    <a href="../rsa_chosen_plain_cipher/" class="dropdown-item">RSA 选择明密文攻击</a>
</li>
            
<li>
    <a href="../rsa_side_channel/" class="dropdown-item">RSA 侧信道攻击</a>
</li>
            
<li>
    <a href="../rsa_pkcs_attack/" class="dropdown-item">Bleichenbacher's attack</a>
</li>
            
<li>
    <a href="../rsa_complex/" class="dropdown-item">RSA 复杂题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">背包加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../knapsack/knapsack/" class="dropdown-item">背包加密</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">离散对数相关</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../discrete-log/discrete-log/" class="dropdown-item">离散对数</a>
</li>
            
<li>
    <a href="../../discrete-log/elgamal/" class="dropdown-item">ElGamal</a>
</li>
            
<li>
    <a href="../../discrete-log/ecc/" class="dropdown-item">ECC</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">格密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../lattice/overview/" class="dropdown-item">格概述</a>
</li>
            
<li>
    <a href="../../lattice/introduction/" class="dropdown-item">基本介绍</a>
</li>
            
<li>
    <a href="../../lattice/lattice-reduction/" class="dropdown-item">格基规约算法</a>
</li>
            
<li>
    <a href="../../lattice/cvp/" class="dropdown-item">CVP</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">哈希函数</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/introduction/" class="dropdown-item">哈希函数</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">MD5</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/md5/" class="dropdown-item">MD5</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SHA1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/sha1/" class="dropdown-item">SHA1</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">FNV</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/fnv/" class="dropdown-item">Fowler–Noll–Vo hash function</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Hash Attack</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/attack/" class="dropdown-item">Hash Attack</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../../hash/complex/" class="dropdown-item">综合题目</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../signature/introduction/" class="dropdown-item">数字签名</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../signature/rsa/" class="dropdown-item">RSA 数字签名</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ElGamal 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../signature/elgamal/" class="dropdown-item">ElGamal</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">DSA 数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../signature/dsa/" class="dropdown-item">DSA</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">攻击思想总结</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../attack-summary/attack-mode/" class="dropdown-item">简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">中间相遇攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../attack-summary/meet-in-the-middle/" class="dropdown-item">中间相遇攻击 - MITM</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">比特攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../attack-summary/bit-attack/" class="dropdown-item">比特攻击</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">证书格式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../certificate/introduction/" class="dropdown-item">证书格式</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Development <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../development/introduction/" class="dropdown-item">Conflux应用开发入门</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">生态开发激励</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/incentive-guide/" class="dropdown-item">生态激励指南</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">开发工具及相关资源介绍</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/tools/" class="dropdown-item">开发工具</a>
</li>
            
<li>
    <a href="../../../../development/resources/" class="dropdown-item">开发资源</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ConfluxScan教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/apply-contract-fee/" class="dropdown-item">为合约申请Conflux赞助额度（合约代付）</a>
</li>
            
<li>
    <a href="../../../../development/address-NFT/" class="dropdown-item">NFT查看器教程</a>
</li>
            
<li>
    <a href="../../../../development/register-contract-and-token-display/" class="dropdown-item">如何在Scan上注册合约和代币展示</a>
</li>
            
<li>
    <a href="../../../../development/get-lp-token-address/" class="dropdown-item">查找LP代币的合约地址</a>
</li>
            
<li>
    <a href="../../../../development/internal-transaction/" class="dropdown-item">交易分析</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Portal钱包教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../development/portal/" class="dropdown-item">Portal安装配置步骤</a>
</li>
            
<li>
    <a href="../../../../development/portal-setting/" class="dropdown-item">Portal钱包常用功能解析</a>
</li>
            
<li>
    <a href="../../../../development/add-token-to-portal/" class="dropdown-item">添加CRC20代币到Portal的方法与步骤</a>
</li>
            
<li>
    <a href="../../../../development/portal-faucet/" class="dropdown-item">ConfluxPortal切换为测试网领取测试币教程</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Ecosystem <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../ecosystem/introduction/" class="dropdown-item">生态介绍</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Conflux基础生态教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../ecosystem/wcfx-cfx-exchange/" class="dropdown-item">WCFX与CFX代币互换</a>
</li>
            
<li>
    <a href="../../../../ecosystem/governance/" class="dropdown-item">Staking合约的质押与解质押</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">常见生态介绍及教程</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../ecosystem/tspace/" class="dropdown-item">Tspace 4.0 NFT平台</a>
</li>
            
<li>
    <a href="../../../../ecosystem/nft-box/" class="dropdown-item">NFTBox创新型资产交互平台</a>
</li>
            
<li>
    <a href="../../../../ecosystem/shuttleflow/" class="dropdown-item">Shuttleflow跨链工具</a>
</li>
            
<li>
    <a href="../../../../ecosystem/moonswap/" class="dropdown-item">moonswap生态</a>
</li>
            
<li>
    <a href="../../../../ecosystem/phantom/" class="dropdown-item">Phantom协议</a>
</li>
            
<li>
    <a href="../../../../ecosystem/dan/" class="dropdown-item">炼丹西游</a>
</li>
            
<li>
    <a href="../../../../ecosystem/guguo/" class="dropdown-item">古国序列</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Web <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../web/introduction/" class="dropdown-item">Web 简介</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SQL 注入</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/sqli/" class="dropdown-item">SQL 注入</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">XSS 跨站脚本攻击</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/xss/" class="dropdown-item">XSS</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">CSRF 跨站请求伪造</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/csrf/" class="dropdown-item">CSRF</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">SSRF 服务端请求伪造</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/ssrf/" class="dropdown-item">SSRF</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">PHP 代码审计</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../web/php/php/" class="dropdown-item">PHP 代码审计</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">BlockChain <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../blockchain/introduction/" class="dropdown-item">BlockChain Security Overview</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Ethereum Security</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../blockchain/ethereum/introduction/" class="dropdown-item">Ethereum Overview</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/basics/" class="dropdown-item">Ethereum Basics</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/selector-encoding/" class="dropdown-item">Function Selector and Argument Encoding</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/storage/" class="dropdown-item">Ethereum Storage</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/opcodes/" class="dropdown-item">Ethereum Opcodes</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Known Attacks</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/re-entrancy/" class="dropdown-item">Re-Entrancy</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/overflow-underflow/" class="dropdown-item">Integer Overflow and Underflow</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/randomness/" class="dropdown-item">Randomness</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/airdrop-hunting/" class="dropdown-item">Airdrop Hunting</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/shortaddress/" class="dropdown-item">Short Address Attack</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/delegatecall/" class="dropdown-item">Delegatecall</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/uninitialized-storage-pointer/" class="dropdown-item">Uninitialized Storage Pointer</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/arbitrarywrite/" class="dropdown-item">Arbitrary Writing</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/create2/" class="dropdown-item">CREATE2</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/attacks/jump-oriented-programming/" class="dropdown-item">Jump Oriented Programming</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../../../blockchain/ethereum/reverse/" class="dropdown-item">Smart Contract Reverse</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/challenges/" class="dropdown-item">区块链比赛题目</a>
</li>
            
<li>
    <a href="../../../../blockchain/ethereum/resources/" class="dropdown-item">学习资源</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Public Blockchain Security</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../blockchain/publicblockchain/introduction/" class="dropdown-item">Public Blockchain Security Overview</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">NFT <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../nft/introduction/" class="dropdown-item">初识NFT</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../../introduction/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../rsa_module_attack/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/conflux-wiki/conflux-wiki/blob/master/docs/zh/docs/crypto/asymmetric/rsa/rsa_theory.md" class="nav-link">Edit on conflux-wiki/conflux-wiki</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#rsa" class="nav-link">RSA 介绍</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">基本原理</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_6" class="nav-link">基本工具</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#jarvis-oj-basic-veryeasyrsa" class="nav-link">Jarvis OJ - Basic - veryeasyRSA</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#2018-codegate-ctf-rsababy" class="nav-link">2018 CodeGate CTF Rsababy</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#2018-pure-math" class="nav-link">2018 国家安全周 pure math</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#2018-pwnhub-lhy" class="nav-link">2018 Pwnhub LHY</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="rsa">RSA 介绍<a class="headerlink" href="#rsa" title="Permanent link">&para;</a></h1>
<p>RSA 加密算法是一种非对称加密算法。在公开密钥加密和电子商业中 RSA 被广泛使用。RSA 是 1977 年由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）一起提出的。RSA 就是他们三人姓氏开头字母拼在一起组成的。</p>
<p>RSA 算法的可靠性由极大整数因数分解的难度决定。换言之，对一极大整数做因数分解愈困难，RSA 算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用 RSA 加密的信息的可靠性就肯定会极度下降。但找到这样的算法的可能性是非常小的。如今，只有短的 RSA 密钥才可能被强力方式解破。到 2017 年为止，还没有任何可靠的攻击 RSA 算法的方式。</p>
<h2 id="_1">基本原理<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="_2">公钥与私钥的产生<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<ol>
<li>随机选择两个不同大质数 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span>，计算 <span class="arithmatex"><span class="MathJax_Preview">N = p \times q</span><script type="math/tex">N = p \times q</script></span></li>
<li>根据欧拉函数，求得 <span class="arithmatex"><span class="MathJax_Preview">\varphi (N)=\varphi (p)\varphi (q)=(p-1)(q-1)</span><script type="math/tex">\varphi (N)=\varphi (p)\varphi (q)=(p-1)(q-1)</script></span></li>
<li>选择一个小于 <span class="arithmatex"><span class="MathJax_Preview">\varphi (N)</span><script type="math/tex">\varphi (N)</script></span> 的整数 <span class="arithmatex"><span class="MathJax_Preview">e</span><script type="math/tex">e</script></span>，使 <span class="arithmatex"><span class="MathJax_Preview">e</span><script type="math/tex">e</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">\varphi (N)</span><script type="math/tex">\varphi (N)</script></span> 互质。并求得 <span class="arithmatex"><span class="MathJax_Preview">e</span><script type="math/tex">e</script></span> 关于 <span class="arithmatex"><span class="MathJax_Preview">\varphi (N)</span><script type="math/tex">\varphi (N)</script></span> 的模反元素，命名为 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>，有 <span class="arithmatex"><span class="MathJax_Preview">ed\equiv 1 \pmod {\varphi (N)}</span><script type="math/tex">ed\equiv 1 \pmod {\varphi (N)}</script></span></li>
<li>将 <span class="arithmatex"><span class="MathJax_Preview">p​</span><script type="math/tex">p​</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">q​</span><script type="math/tex">q​</script></span> 的记录销毁</li>
</ol>
<p>此时，<span class="arithmatex"><span class="MathJax_Preview">(N,e)</span><script type="math/tex">(N,e)</script></span> 是公钥，<span class="arithmatex"><span class="MathJax_Preview">(N,d)</span><script type="math/tex">(N,d)</script></span> 是私钥。</p>
<h3 id="_3">消息加密<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>首先需要将消息 以一个双方约定好的格式转化为一个小于 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>，且与 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 互质的整数 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>。如果消息太长，可以将消息分为几段，这也就是我们所说的块加密，后对于每一部分利用如下公式加密：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
m^{e}\equiv c\pmod N
</div>
<script type="math/tex; mode=display">
m^{e}\equiv c\pmod N
</script>
</div>
<h3 id="_4">消息解密<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>利用密钥 <span class="arithmatex"><span class="MathJax_Preview">d​</span><script type="math/tex">d​</script></span> 进行解密。</p>
<div class="arithmatex">
<div class="MathJax_Preview">
c^{d}\equiv m\pmod N
</div>
<script type="math/tex; mode=display">
c^{d}\equiv m\pmod N
</script>
</div>
<h3 id="_5">正确性证明<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>即我们要证<span class="arithmatex"><span class="MathJax_Preview">m^{ed} \equiv m \bmod N</span><script type="math/tex">m^{ed} \equiv m \bmod N</script></span>，已知<span class="arithmatex"><span class="MathJax_Preview">ed \equiv 1 \bmod \phi(N)</span><script type="math/tex">ed \equiv 1 \bmod \phi(N)</script></span>，那么 <span class="arithmatex"><span class="MathJax_Preview">ed=k\phi(N)+1</span><script type="math/tex">ed=k\phi(N)+1</script></span>，即需要证明</p>
<div class="arithmatex">
<div class="MathJax_Preview">
m^{k\phi(N)+1}  \equiv m \bmod N
</div>
<script type="math/tex; mode=display">
m^{k\phi(N)+1}  \equiv m \bmod N
</script>
</div>
<p>这里我们分两种情况证明</p>
<p>第一种情况 <span class="arithmatex"><span class="MathJax_Preview">gcd(m,N)=1​</span><script type="math/tex">gcd(m,N)=1​</script></span>，那么 <span class="arithmatex"><span class="MathJax_Preview">m^{\phi(N)} \equiv 1 \bmod N​</span><script type="math/tex">m^{\phi(N)} \equiv 1 \bmod N​</script></span>，因此原式成立。</p>
<p>第二种情况 <span class="arithmatex"><span class="MathJax_Preview">gcd(m,N)\neq 1</span><script type="math/tex">gcd(m,N)\neq 1</script></span>，那么 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 必然是 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 或者 <span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span> 的倍数，并且 <span class="arithmatex"><span class="MathJax_Preview">n=m</span><script type="math/tex">n=m</script></span> 小于 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>。我们假设</p>
<div class="arithmatex">
<div class="MathJax_Preview">
m=xp
</div>
<script type="math/tex; mode=display">
m=xp
</script>
</div>
<p>那么 <span class="arithmatex"><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> 必然小于 <span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span>，又由于 <span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span> 是素数。那么</p>
<div class="arithmatex">
<div class="MathJax_Preview">
m^{\phi(q)} \equiv 1 \bmod q
</div>
<script type="math/tex; mode=display">
m^{\phi(q)} \equiv 1 \bmod q
</script>
</div>
<p>进而</p>
<div class="arithmatex">
<div class="MathJax_Preview">
m^{k\phi(N)}=m^{k(p-1)(q-1)}=(m^{\phi(q)})^{k(p-1)} \equiv 1 \bmod q
</div>
<script type="math/tex; mode=display">
m^{k\phi(N)}=m^{k(p-1)(q-1)}=(m^{\phi(q)})^{k(p-1)} \equiv 1 \bmod q
</script>
</div>
<p>那么</p>
<div class="arithmatex">
<div class="MathJax_Preview">
m^{k\phi(N)+1}=m+uqm
</div>
<script type="math/tex; mode=display">
m^{k\phi(N)+1}=m+uqm
</script>
</div>
<p>进而</p>
<div class="arithmatex">
<div class="MathJax_Preview">
m^{k\phi(N)+1}=m+uqxp=m+uxN
</div>
<script type="math/tex; mode=display">
m^{k\phi(N)+1}=m+uqxp=m+uxN
</script>
</div>
<p>所以原式成立。</p>
<h2 id="_6">基本工具<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<h3 id="rsatool">RSAtool<a class="headerlink" href="#rsatool" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>安装</p>
<pre class="highlight"><code class="language-bash">git clone https://github.com/ius/rsatool.git
cd rsatool
python rsatool.py -h</code></pre>
</li>
<li>
<p>生成私钥</p>
<pre class="highlight"><code class="language-bash">python rsatool.py -f PEM -o private.pem -p 1234567 -q 7654321</code></pre>
</li>
</ul>
<h3 id="rsa-converter">RSA Converter<a class="headerlink" href="#rsa-converter" title="Permanent link">&para;</a></h3>
<ul>
<li>根据给定密钥对，生成 pem 文件</li>
<li>根据 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>，<span class="arithmatex"><span class="MathJax_Preview">e</span><script type="math/tex">e</script></span>，<span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> 得出 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>，<span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span></li>
</ul>
<h3 id="openssl">openssl<a class="headerlink" href="#openssl" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>查看公钥文件</p>
<pre class="highlight"><code class="language-shell">openssl rsa -pubin -in pubkey.pem -text -modulus</code></pre>
</li>
<li>
<p>解密</p>
<pre class="highlight"><code class="language-shell">rsautl -decrypt -inkey private.pem -in flag.enc -out flag</code></pre>
</li>
</ul>
<p>更加具体的细节请参考 <code>openssl --help</code>。</p>
<h3 id="_7">分解整数工具<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<ul>
<li>网站分解，<a href="http://factordb.com/">factor.db</a></li>
<li>命令行分解，<a href="https://github.com/ryosan-470/factordb-pycli">factordb-pycli</a>，借用 factordb 数据库。</li>
<li><a href="https://sourceforge.net/projects/yafu/">yafu</a></li>
</ul>
<h3 id="python">python 库<a class="headerlink" href="#python" title="Permanent link">&para;</a></h3>
<h4 id="primefac">primefac<a class="headerlink" href="#primefac" title="Permanent link">&para;</a></h4>
<p>整数分解库，包含了很多整数分解的算法。</p>
<h4 id="gmpy">gmpy<a class="headerlink" href="#gmpy" title="Permanent link">&para;</a></h4>
<ul>
<li><code>gmpy.root(a, b)</code>，返回一个元组 <code>(x, y)</code>，其中 <code>x</code> 为 <code>a</code> 开 <code>b</code> 次方的值，<code>y</code> 是判断 <code>x</code> 是否为整数的布尔型变量</li>
</ul>
<h4 id="gmpy2">gmpy2<a class="headerlink" href="#gmpy2" title="Permanent link">&para;</a></h4>
<p>安装时，可能会需要自己另行安装 mpfr 与 mpc 库。</p>
<ul>
<li><code>gmpy2.iroot(a, b)</code>，类似于 <code>gmpy.root(a,b)</code></li>
</ul>
<h4 id="pycrypto">pycrypto<a class="headerlink" href="#pycrypto" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>安装</p>
<pre class="highlight"><code class="language-bash">sudo pip install pycrypto</code></pre>
</li>
<li>
<p>使用</p>
<pre class="highlight"><code class="language-python">import gmpy
from Crypto.Util.number import *
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_v1_5

msg = 'crypto here'
p = getPrime(128)
q = getPrime(128)
n = p*q
e = getPrime(64)
pubkey = RSA.construct((long(n), long(e)))
privatekey = RSA.construct((long(n), long(e), long(d), long(p), long(q)))
key = PKCS1_v1_5.new(pubkey)
enc = key.encrypt(msg).encode('base64')
key = PKCS1_v1_5.new(privatekey)
msg = key.decrypt(enc.decode('base64'), e)</code></pre>
</li>
</ul>
<h2 id="jarvis-oj-basic-veryeasyrsa">Jarvis OJ - Basic - veryeasyRSA<a class="headerlink" href="#jarvis-oj-basic-veryeasyrsa" title="Permanent link">&para;</a></h2>
<blockquote>
<p>p = 3487583947589437589237958723892346254777 q = 8767867843568934765983476584376578389</p>
<p>e = 65537</p>
<p>求 d = </p>
<p>请提交 <code>PCTF{d}</code></p>
</blockquote>
<p>直接根据 <span class="arithmatex"><span class="MathJax_Preview">ed\equiv 1 \pmod{\varphi (N)}</span><script type="math/tex">ed\equiv 1 \pmod{\varphi (N)}</script></span>，其中 <span class="arithmatex"><span class="MathJax_Preview">\varphi (N)=\varphi (p)\varphi (q)=(p-1)(q-1)</span><script type="math/tex">\varphi (N)=\varphi (p)\varphi (q)=(p-1)(q-1)</script></span>，可得 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>。</p>
<pre class="highlight"><code class="language-python">import gmpy2
p = 3487583947589437589237958723892346254777
q = 8767867843568934765983476584376578389
e = 65537
phin = (p - 1) * (q - 1)
print gmpy2.invert(e, phin)</code></pre>
<pre class="highlight"><code class="language-shell">➜  Jarvis OJ-Basic-veryeasyRSA git:(master) ✗ python exp.py       
19178568796155560423675975774142829153827883709027717723363077606260717434369</code></pre>
<h2 id="2018-codegate-ctf-rsababy">2018 CodeGate CTF Rsababy<a class="headerlink" href="#2018-codegate-ctf-rsababy" title="Permanent link">&para;</a></h2>
<p>程序就是一个简单的 RSA，不过程序还生成了两个奇怪的数</p>
<pre class="highlight"><code class="language-python">e = 65537
n = p * q
pi_n = (p-1)*(q-1)
d = mulinv(e, pi_n)
h = (d+p)^(d-p)
g = d*(p-0xdeadbeef)</code></pre>
<p>所以，问题应该出自这里，所以我们就从此下手，不放这里先假设 <code>const = 0xdeadbeef</code>。那么</p>
<div class="arithmatex">
<div class="MathJax_Preview">
eg = ed * (p-const)
</div>
<script type="math/tex; mode=display">
eg = ed * (p-const)
</script>
</div>
<p>进而，根据 RSA 可知</p>
<div class="arithmatex">
<div class="MathJax_Preview">
2^{eg}=2^{ed * (p-const)}=2^{p-const} \pmod n
</div>
<script type="math/tex; mode=display">
2^{eg}=2^{ed * (p-const)}=2^{p-const} \pmod n
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
2^{p-const} * 2^{const-1} = 2^{p-1} \pmod n
</div>
<script type="math/tex; mode=display">
2^{p-const} * 2^{const-1} = 2^{p-1} \pmod n
</script>
</div>
<p>所以</p>
<div class="arithmatex">
<div class="MathJax_Preview">
2^{p-1} = 2^{eg} * 2^{const-1}+kn
</div>
<script type="math/tex; mode=display">
2^{p-1} = 2^{eg} * 2^{const-1}+kn
</script>
</div>
<p>而与此同时根据费马小定理，我们知道</p>
<div class="arithmatex">
<div class="MathJax_Preview">
2^{p-1} \equiv 1 \pmod p
</div>
<script type="math/tex; mode=display">
2^{p-1} \equiv 1 \pmod p
</script>
</div>
<p>所以</p>
<div class="arithmatex">
<div class="MathJax_Preview">
p|2^{p-1}-1 | 2^{eg+const-1}-1+kn
</div>
<script type="math/tex; mode=display">
p|2^{p-1}-1 | 2^{eg+const-1}-1+kn
</script>
</div>
<p>进而</p>
<div class="arithmatex">
<div class="MathJax_Preview">
p|2^{eg+const-1}-1
</div>
<script type="math/tex; mode=display">
p|2^{eg+const-1}-1
</script>
</div>
<p>所以</p>
<div class="arithmatex">
<div class="MathJax_Preview">
p|gcd(2^{eg+const-1}-1,n)
</div>
<script type="math/tex; mode=display">
p|gcd(2^{eg+const-1}-1,n)
</script>
</div>
<p>因此，代码如下</p>
<pre class="highlight"><code class="language-python">tmp = gmpy2.powmod(2,e*g+const-1,n)-1
p = gmpy2.gcd(tmp,n)
q = n/p
phin = (p-1)*(q-1)
d =gmpy2.invert(e,phin)
plain = gmpy2.powmod(data,d,n)
print hex(plain)[2:].decode('hex')</code></pre>
<h2 id="2018-pure-math">2018 国家安全周 pure math<a class="headerlink" href="#2018-pure-math" title="Permanent link">&para;</a></h2>
<p>题目的基本描述是这个样子的</p>
<pre class="highlight"><code>1) p ** p % q = 1137973316343089029387365135250835133803975869258714714790597743585251681751361684698632609164883988455302237641489036138661596754239799122081528662395492
2) q ** q % p = 6901383184477756324584651464895743132603115552606852729050186289748558760692261058141015199261946483809004373728135568483701274908717004197776113227815323
3) (p ** q + q ** p) % (p*q) = 16791287391494893024031688699360885996180880807427715700800644759680986120242383930558410147341340225420991368114858791447699399702390358184412301644459406
4) (p+q) ** (p+q) % (p*q) = 63112211860889153729003401381621068190906433969243079543438386686621389392583849748240273643614258173423474299387234175508649197780206757067354426424570586101908571600743792328163163458500138799976944702155779196849585083397395750018148652864158388247163109077215394538930498877175474225571393901460434679279
5) FLAG ** 31337 % (p*q) = 6931243291746179589612148118911670244427928875888377273917973305632621316868302667641610838193899081089153471883271406133321321416064760200919958612671379845738048938060512995550639898688604592620908415248701721672948126507753670027043162669545932921683579001870526727737212722417683610956855529996310258030
Now, what’s the FLAG???</code></pre>
<p>我们的目的基本上就是求得 FLAG，那么怎么做呢?这个题目需要我们具有较好的数论功底。</p>
<p>根据题目中这样的内容，我们可以假设 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>，<span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span> 都是大素数，那么</p>
<p><span class="arithmatex"><span class="MathJax_Preview">p^{q-1} \equiv  1\bmod q</span><script type="math/tex">p^{q-1} \equiv  1\bmod q</script></span></p>
<p>那么</p>
<p><span class="arithmatex"><span class="MathJax_Preview">p^{q} \equiv p \bmod pq</span><script type="math/tex">p^{q} \equiv p \bmod pq</script></span></p>
<p>那么我们可以根据 3）知道</p>
<p><span class="arithmatex"><span class="MathJax_Preview">p^q+q^p \equiv p+q \bmod pq</span><script type="math/tex">p^q+q^p \equiv p+q \bmod pq</script></span></p>
<p>而 <span class="arithmatex"><span class="MathJax_Preview">p+q</span><script type="math/tex">p+q</script></span> 又显然小于 <span class="arithmatex"><span class="MathJax_Preview">pq</span><script type="math/tex">pq</script></span>，所以我们就知道 <span class="arithmatex"><span class="MathJax_Preview">p+q</span><script type="math/tex">p+q</script></span> 的数值。</p>
<p>进一步，我们假设1），2），3），4），5）对应的值分别为 <span class="arithmatex"><span class="MathJax_Preview">x_1</span><script type="math/tex">x_1</script></span>, <span class="arithmatex"><span class="MathJax_Preview">x_2</span><script type="math/tex">x_2</script></span>, <span class="arithmatex"><span class="MathJax_Preview">x_3</span><script type="math/tex">x_3</script></span>, <span class="arithmatex"><span class="MathJax_Preview">x_4</span><script type="math/tex">x_4</script></span>, <span class="arithmatex"><span class="MathJax_Preview">x_5</span><script type="math/tex">x_5</script></span> 则</p>
<p>根据4），我们可以知道</p>
<p><span class="arithmatex"><span class="MathJax_Preview">(p+q)^{p+q} \equiv p^{p+q}+q^{p+q} \bmod pq</span><script type="math/tex">(p+q)^{p+q} \equiv p^{p+q}+q^{p+q} \bmod pq</script></span></p>
<p>又因为1）和 2），则</p>
<p><span class="arithmatex"><span class="MathJax_Preview">p^pp \equiv px_1\bmod pq</span><script type="math/tex">p^pp \equiv px_1\bmod pq</script></span></p>
<p><span class="arithmatex"><span class="MathJax_Preview">q^qq \equiv qx_2 \bmod pq</span><script type="math/tex">q^qq \equiv qx_2 \bmod pq</script></span></p>
<p>因此</p>
<p><span class="arithmatex"><span class="MathJax_Preview">px_1+qx_2 \equiv x_4 \bmod pq</span><script type="math/tex">px_1+qx_2 \equiv x_4 \bmod pq</script></span></p>
<p>根据 <span class="arithmatex"><span class="MathJax_Preview">x_1</span><script type="math/tex">x_1</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">x_2</span><script type="math/tex">x_2</script></span> 的求得方式，我们可以知道这里也是等号，因此我们得到了一个二元一次方程组，直接求解即可。</p>
<pre class="highlight"><code class="language-python">import gmpy2
x1 = 1137973316343089029387365135250835133803975869258714714790597743585251681751361684698632609164883988455302237641489036138661596754239799122081528662395492
x2 = 6901383184477756324584651464895743132603115552606852729050186289748558760692261058141015199261946483809004373728135568483701274908717004197776113227815323
p_q = 16791287391494893024031688699360885996180880807427715700800644759680986120242383930558410147341340225420991368114858791447699399702390358184412301644459406
x4 = 63112211860889153729003401381621068190906433969243079543438386686621389392583849748240273643614258173423474299387234175508649197780206757067354426424570586101908571600743792328163163458500138799976944702155779196849585083397395750018148652864158388247163109077215394538930498877175474225571393901460434679279

if (x4 - x1 * p_q) % (x2 - x1) == 0:
    print 'True'
q = (x4 - x1 * p_q) / (x2 - x1)
print q
p = p_q - q

c = 6931243291746179589612148118911670244427928875888377273917973305632621316868302667641610838193899081089153471883271406133321321416064760200919958612671379845738048938060512995550639898688604592620908415248701721672948126507753670027043162669545932921683579001870526727737212722417683610956855529996310258030

phin = (p - 1) * (q - 1)
d = gmpy2.invert(31337, phin)
flag = gmpy2.powmod(c, d, p * q)
flag = hex(flag)[2:]
print flag.decode('hex')</code></pre>
<p>flag  如下</p>
<pre class="highlight"><code class="language-shell">➜  2018-国家安全周第一场-puremath git:(master) ✗ python exp.py
True
7635093784603905632817000902311635311970645531806863592697496927519352405158721310359124595712780726701027634372170535318453656286180828724079479352052417
flag{6a66b8d5-6047-4299-a48e-4c4d1f874d12}</code></pre>
<h2 id="2018-pwnhub-lhy">2018 Pwnhub LHY<a class="headerlink" href="#2018-pwnhub-lhy" title="Permanent link">&para;</a></h2>
<p>首先分析这段代码</p>
<pre class="highlight"><code class="language-python">assert gmpy.is_prime(y)**2016 + gmpy.is_prime(x + 1)**2017 + (
    (x**2 - 1)**2 % (2 * x * y - 1) + 2
)**2018 == 30097557298197417800049182668952226601954645169633891463401117760245367082644152355564014438095421962150109895432272944128252155287648477680131934943095113263121691874508742328500559321036238322775864636883202538152031804102118831278605474474352011895348919417742923873371980983336517409056008233804190890418285814476821890492630167665485823056526646050928460488168341721716361299816947722947465808004305806687049198633489997459201469227952552870291934919760829984421958853221330987033580524592596407485826446284220272614663464267135596497185086055090126893989371261962903295313304735911034185619611156742146</code></pre>
<p>由于 <code>gmpy.is_prime</code> 要么返回1，要么返回 0，所以我们可以很容易地试出来 <code>y</code> 是素数，<code>x+1</code> 也是素数，并且</p>
<p><span class="arithmatex"><span class="MathJax_Preview">(x^2-1)^2\equiv 0 \bmod (2xy-1)</span><script type="math/tex">(x^2-1)^2\equiv 0 \bmod (2xy-1)</script></span></p>
<p>为了式子能够整除，猜测 <span class="arithmatex"><span class="MathJax_Preview">x=2y</span><script type="math/tex">x=2y</script></span> 。</p>
<p>于是，对于下面的内容</p>
<pre class="highlight"><code class="language-python">p = gmpy.next_prime(x**3 + y**3)
q = gmpy.next_prime(x**2 * y + y**2 * x)
n = p * q
phi = (p - 1) * (q - 1)
d = gmpy.invert(0x10001, phi)
enc = pow(bytes_to_long(flag), 0x10001, n)
print 'n =', n
print 'enc =', enc</code></pre>
<p><span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span> 自然为</p>
<p><span class="arithmatex"><span class="MathJax_Preview">p=next\_prime(9y^3)</span><script type="math/tex">p=next\_prime(9y^3)</script></span></p>
<p><span class="arithmatex"><span class="MathJax_Preview">q=next\_prime(6y^3)</span><script type="math/tex">q=next\_prime(6y^3)</script></span></p>
<p>根据素数的间隔，可以知道 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span> 最多比括号里的数字大一点，这里一般不会超过 <span class="arithmatex"><span class="MathJax_Preview">1000</span><script type="math/tex">1000</script></span>。</p>
<p>那么</p>
<p><span class="arithmatex"><span class="MathJax_Preview">n \geq 54y^6</span><script type="math/tex">n \geq 54y^6</script></span></p>
<p>所以我们知道了 <span class="arithmatex"><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span> 的上界，而对于 <span class="arithmatex"><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span> 的下界其实也不会离上界太远，我们大概减个几十万。进而，我们利用二分查找的方式来寻找 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span>，如下</p>
<pre class="highlight"><code class="language-python">import gmpy2
tmp = 30097557298197417800049182668952226601954645169633891463401117760245367082644152355564014438095421962150109895432272944128252155287648477680131934943095113263121691874508742328500559321036238322775864636883202538152031804102118831278605474474352011895348919417742923873371980983336517409056008233804190890418285814476821890492630167665485823056526646050928460488168341721716361299816947722947465808004305806687049198633489997459201469227952552870291934919760829984421958853221330987033580524592596407485826446284220272614663464267135596497185086055090126893989371261962903295313304735911034185619611156742146

print gmpy2.iroot(tmp, 2018)
print gmpy2.iroot(tmp - 1, 2018)

print gmpy2.iroot(tmp - 2, 2018)

n = 260272753019642842691231717156206014402348296256668058656902033827190888150939144319270903947159599144884859205368557385941127216969379550487700198771513118894125094678559478972591331182960004648132846372455712958337042783083099376871113795475285658106058675217077803768944674144803250791799957440111855021945690877200606577646234107957498370758707097662736662439460472126493593605957225541979181422479704018055731221681621886820626215670393536343427267329350730257979042198593215747542270975288047196483958369426727778580292311145109908665004662296440533724591193527886702374790526322791818523938910660223971454070731594803459613066617828657725704376475527288174777197739360634209448477565044519733575375490101670974499385760735451471034271880800081246883157088501597655371430353965493264345172541221268942926210055390568364981514774743693528424196241142665685211916330254113610598390909248626686397970038848966187547231199741

y = 191904757378974300059526915134037747982760255307942501070454569331878491189601823952845623286161325306079772871025816081849039036850918375408172174102720702781463514549851887084613000000L
y = gmpy2.next_prime(y)

enc = 73933313646416156737449236838459526871566017180178176765840447023088664788672323530940171469589918772272559607026808711216932468486201094786991159096267208480969757088208089800600731106685561375522764783335332964711981392251568543122418192877756299395774738176188452197889668610818741062203831272066261677731889616150485770623945568369493256759711422067551058418926344060504112146971937651406886327429318390247733970549845424064244469193626197360072341969574784310397213033860597822010667926563087858301337091484951760613299203587677078666096526093414014637559237148644939541419075479462431789925219269815364529507771308181435591670281081465439913711912925412078002618729159141400730636976744132429329651487292506365655834202469178066850282850374067239317928012461993443785247524500680257923687511378073703423047348824611101206633407452837948194591695712958510124436821151767823443033286425729473563002691262316964646014201612

end = gmpy2.iroot(n / 54, 6)[0]
beg = end - 2000000

mid = 1
while beg &lt; end:
    mid = (beg + end) / 2
    if gmpy2.is_prime(mid) != 1:
        mid = gmpy2.next_prime(mid)
    p = gmpy2.next_prime(9 * mid**3)
    q = gmpy2.next_prime(6 * mid**3)
    n1 = p * q
    if n1 == n:
        print p, q
        phin = (p - 1) * (q - 1)
        d = gmpy2.invert(0x10001, phin)
        m = gmpy2.powmod(enc, d, n)
        print hex(m)[2:].strip('L').decode('hex')
        print 'ok'
        exit(0)
    elif n1 &lt; n:
        beg = mid
    else:
        end = mid
    print beg, end</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2020 - 2021 Conflux Wiki Team</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
        <script src="../../../../static/js/extra.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
